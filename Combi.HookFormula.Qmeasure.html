<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Combi.HookFormula.Qmeasure</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Combi.HookFormula.Qmeasure</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab77"></a><h1 class="section">Qmeasure.v: Definition of finite probabilities as measures with values in rational numbers</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Misc</span> <span class="id" title="var">Ccpo</span>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">mathcomp.ssreflect.ssreflect</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">GRing</span>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">Num.Theory</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">ring_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">ratO</span> : <span class="id" title="var">ord</span> <span class="id" title="var">rat</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">Oeq</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">rat</span> ⇒ <span class="id" title="var">n</span> = <span class="id" title="var">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ole</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">rat</span> ⇒ (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">R</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Functions to be measured 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">MF</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) := <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">MFO</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="var">ord</span> (<span class="id" title="var">MF</span> <span class="id" title="var">A</span>) := <span class="id" title="var">ford</span> <span class="id" title="var">A</span> <span class="id" title="var">rat</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
Type of measures on <span class="inlinecode"><a class="idref" href="Combi.LRrule.freeSchur.html#TableauReading.A"><span class="id" title="variable">A</span></a></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">M</span> <span class="id" title="var">A</span> := <span class="id" title="var">MF</span> <span class="id" title="var">A</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">rat</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">MO</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="var">ord</span> (<span class="id" title="var">M</span> <span class="id" title="var">A</span>) := <span class="id" title="var">fmono</span> (<span class="id" title="var">MF</span> <span class="id" title="var">A</span>) <span class="id" title="var">rat</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">app_mon</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) : <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>) ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">app_mon</span>.<br/>

<br/>
</div>

<div class="doc">
Monadic operators on M A 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">munit</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) : <span class="id" title="var">M</span> <span class="id" title="var">A</span> := <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>) ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mstar</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>), <span class="id" title="var">M</span> <span class="id" title="var">A</span> → (<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>) → <span class="id" title="var">M</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">star_simpl</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">F</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mstar</span> <span class="id" title="var">a</span> <span class="id" title="var">F</span> <span class="id" title="var">f</span> =  <span class="id" title="var">a</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">f</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab78"></a><h2 class="section">Properties of monadic operators</h2>

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">law1</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">F</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">B</span>), <span class="id" title="var">mstar</span> (<span class="id" title="var">munit</span> <span class="id" title="var">x</span>) <span class="id" title="var">F</span> <span class="id" title="var">f</span> == <span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">law2</span> :<br/>
&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>), <span class="id" title="var">mstar</span> <span class="id" title="var">a</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span> ⇒ <span class="id" title="var">munit</span> <span class="id" title="var">x</span>) <span class="id" title="var">f</span> == <span class="id" title="var">a</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">law3</span> :<br/>
&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">F</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>) (<span class="id" title="var">G</span>:<span class="id" title="var">B</span> → <span class="id" title="var">M</span> <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">C</span>), <span class="id" title="var">mstar</span> (<span class="id" title="var">mstar</span> <span class="id" title="var">a</span> <span class="id" title="var">F</span>) <span class="id" title="var">G</span> <span class="id" title="var">f</span> == <span class="id" title="var">mstar</span> <span class="id" title="var">a</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span> ⇒ <span class="id" title="var">mstar</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span>) <span class="id" title="var">G</span>) <span class="id" title="var">f</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab79"></a><h2 class="section">Properties of distributions</h2>
<a name="lab80"></a><h3 class="section">Expected properties of measures</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stable_add</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>, <span class="id" title="var">m</span> (<span class="id" title="var">f</span> \+ <span class="id" title="var">g</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) + (<span class="id" title="var">m</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stable_sub</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>, <span class="id" title="var">m</span> (<span class="id" title="var">f</span> \- <span class="id" title="var">g</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) - (<span class="id" title="var">m</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stable_mull</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">k</span>:<span class="id" title="var">rat</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>), <span class="id" title="var">m</span> (<span class="id" title="var">k</span> \*<span class="id" title="var">o</span> <span class="id" title="var">f</span>) = <span class="id" title="var">k</span> × (<span class="id" title="var">m</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">stable_opp</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">A</span>), <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ - (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) = - (<span class="id" title="var">m</span> <span class="id" title="var">f</span>).<br/>

<br/>
</div>

<div class="doc">
Linearity on rational is deduced from stability with respect to substraction 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">StabilityProperties</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">m</span> : <span class="id" title="var">M</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">Mstable_sub</span> : <span class="id" title="var">stable_sub</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_eq</span> : <span class="id" title="var">stable</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Mstable_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable0</span> : <span class="id" title="var">m</span> \0 = 0.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Mstable0</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_opp</span> : <span class="id" title="var">stable_opp</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Mstable_opp</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_add</span> : <span class="id" title="var">stable_add</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Mstable_add</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_addn</span> (<span class="id" title="var">f</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> *+ <span class="id" title="var">n</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) *+ <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_subn</span> (<span class="id" title="var">f</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> *- <span class="id" title="var">n</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) *- <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_divn</span> (<span class="id" title="var">f</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) : <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> / <span class="id" title="var">n</span>%:<span class="id" title="var">Q</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) / (<span class="id" title="var">n</span>%:<span class="id" title="var">Q</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_addi</span> (<span class="id" title="var">f</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">int</span>) : <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> *~ <span class="id" title="var">n</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) *~ <span class="id" title="var">n</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_muli</span> (<span class="id" title="var">f</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">int</span>) : <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">n</span>%:<span class="id" title="var">Q</span> × <span class="id" title="var">f</span> <span class="id" title="var">x</span>) = (<span class="id" title="var">n</span>%:<span class="id" title="var">Q</span>) × (<span class="id" title="var">m</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_divi</span> (<span class="id" title="var">f</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>) (<span class="id" title="var">n</span> : <span class="id" title="var">int</span>) : <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> / <span class="id" title="var">n</span>%:<span class="id" title="var">Q</span>) = (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) / (<span class="id" title="var">n</span>%:<span class="id" title="var">Q</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_mull</span> : <span class="id" title="var">stable_mull</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mstable_linear</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">rat</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">m</span> ((<span class="id" title="var">p</span> \*<span class="id" title="var">o</span> <span class="id" title="var">f</span>) \+ (<span class="id" title="var">q</span> \*<span class="id" title="var">o</span> <span class="id" title="var">g</span>)) = <span class="id" title="var">p</span> × (<span class="id" title="var">m</span> <span class="id" title="var">f</span>) + <span class="id" title="var">q</span> × (<span class="id" title="var">m</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">StabilityProperties</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unit_stable_eq</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>), <span class="id" title="var">stable</span> (<span class="id" title="var">munit</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">star_stable_eq</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">F</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>), <span class="id" title="var">stable</span> (<span class="id" title="var">mstar</span> <span class="id" title="var">m</span> <span class="id" title="var">F</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unit_monotonic</span> <span class="id" title="var">A</span> (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">MF</span> <span class="id" title="var">A</span>):(<span class="id" title="var">f</span> ≤ <span class="id" title="var">g</span>)%<span class="id" title="var">O</span> → <span class="id" title="var">munit</span> <span class="id" title="var">x</span> <span class="id" title="var">f</span> ≤ <span class="id" title="var">munit</span> <span class="id" title="var">x</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">star_monotonic</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">F</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">MF</span> <span class="id" title="var">B</span>) : (<span class="id" title="var">f</span> ≤ <span class="id" title="var">g</span>)%<span class="id" title="var">O</span> → <span class="id" title="var">mstar</span> <span class="id" title="var">m</span> <span class="id" title="var">F</span> <span class="id" title="var">f</span> ≤ <span class="id" title="var">mstar</span> <span class="id" title="var">m</span> <span class="id" title="var">F</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">star_le_compat</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">F1</span> <span class="id" title="var">F2</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">m1</span> ≤ <span class="id" title="var">m2</span>)%<span class="id" title="var">O</span> → (<span class="id" title="var">F1</span> ≤ <span class="id" title="var">F2</span>)%<span class="id" title="var">O</span> → (<span class="id" title="var">mstar</span> <span class="id" title="var">m1</span> <span class="id" title="var">F1</span> ≤ <span class="id" title="var">mstar</span> <span class="id" title="var">m2</span> <span class="id" title="var">F2</span>)%<span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">star_le_compat</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab81"></a><h3 class="section">Stability for substraction of unit and star</h3>

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">unit_stable_sub</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>), <span class="id" title="var">stable_sub</span> (<span class="id" title="var">munit</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">star_stable_sub</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">M</span> <span class="id" title="var">A</span>) (<span class="id" title="var">F</span>:<span class="id" title="var">A</span> → <span class="id" title="var">M</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">stable_sub</span> <span class="id" title="var">m</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">a</span>:<span class="id" title="var">A</span>, <span class="id" title="var">stable_sub</span> (<span class="id" title="var">F</span> <span class="id" title="var">a</span>)) → <span class="id" title="var">stable_sub</span> (<span class="id" title="var">mstar</span> <span class="id" title="var">m</span> <span class="id" title="var">F</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab82"></a><h2 class="section">Definition of distribution</h2>

Finite distributions are monotonic measure functions such that

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="Combi.HookFormula.Qmeasure.html#mu"><span class="id" title="projection">mu</span></a></span> <span class="inlinecode">(<a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene.html#g"><span class="id" title="variable">g</span></a>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><a class="idref" href="Combi.HookFormula.Qmeasure.html#mu"><span class="id" title="projection">mu</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">-</span> <span class="inlinecode"><a class="idref" href="Combi.HookFormula.Qmeasure.html#mu"><span class="id" title="projection">mu</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene.html#g"><span class="id" title="variable">g</span></a></span>

</li>
<li> <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="Combi.HookFormula.Qmeasure.html#mu"><span class="id" title="projection">mu</span></a></span> <span class="inlinecode">1</span> <span class="inlinecode">=</span> <span class="inlinecode">1</span>

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">distr</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <br/>
&nbsp;&nbsp;{<span class="id" title="var">mu</span> : <span class="id" title="var">M</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_stable_sub</span> : <span class="id" title="var">stable_sub</span> <span class="id" title="var">mu</span>; <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu_prob</span> : <span class="id" title="var">mu</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ 1%:<span class="id" title="var">Q</span>) = 1}.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_stable_sub</span> <span class="id" title="var">mu_prob</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab83"></a><h2 class="section">Properties of measures</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_monotonic</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) : <span class="id" title="var">monotonic</span> (<span class="id" title="var">mu</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_monotonic</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_eq</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) : <span class="id" title="var">stable</span> (<span class="id" title="var">mu</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_stable_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_zero</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> \0 = 0.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_zero</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_zero_eq</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = 0) → <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span> = 0.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">mu_zero_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_one_eq</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = 1) → <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span> = 1.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">mu_one_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_inv</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ 1 - <span class="id" title="var">f</span> <span class="id" title="var">x</span>) = 1 - (<span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_stable_inv</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_add</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> <span class="id" title="var">g</span>: <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="var">f</span> \+ <span class="id" title="var">g</span>) = <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span> + <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_stable_add</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_mull</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">q</span> <span class="id" title="var">f</span> : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="var">q</span> \*<span class="id" title="var">o</span> <span class="id" title="var">f</span>) = <span class="id" title="var">q</span> × <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_stable_mull</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_add_zero</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span> = 0 → <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">g</span> = 0 → <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="var">f</span> \+ <span class="id" title="var">g</span>) = 0.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_add_zero</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_pos</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> : (\0 ≤ <span class="id" title="var">f</span>)%<span class="id" title="var">O</span> → 0 ≤ <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_le1</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> ≤ 1) → <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span> ≤ 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_cte</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">c</span>:<span class="id" title="var">rat</span>) : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">c</span>) = <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_cte</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_mulr</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">c</span>:<span class="id" title="var">rat</span>) <span class="id" title="var">f</span> : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="var">c</span> \<span class="id" title="var">o</span>× <span class="id" title="var">f</span>) = (<span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span>) × <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_inv_inv</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) <span class="id" title="var">f</span> : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> <span class="id" title="var">f</span> = 1 - <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ 1 - <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span>  <span class="id" title="var">mu_stable_inv_inv</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Odistr</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="var">ord</span> (<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">Ole</span> := <span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) ⇒ (<span class="id" title="var">mu</span> <span class="id" title="var">f</span> ≤ <span class="id" title="var">mu</span> <span class="id" title="var">g</span>)%<span class="id" title="var">O</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Oeq</span> := <span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) ⇒ <span class="id" title="var">Oeq</span> (<span class="id" title="var">mu</span> <span class="id" title="var">f</span>) (<span class="id" title="var">mu</span> <span class="id" title="var">g</span>)}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab84"></a><h2 class="section">Monadic operators for distributions</h2>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Munit</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>, <span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Mlet</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>, <span class="id" title="var">distr</span> <span class="id" title="var">A</span> → (<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>) → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Munit_simpl</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">q</span>:<span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) <span class="id" title="var">x</span>, <span class="id" title="var">mu</span> (<span class="id" title="var">Munit</span> <span class="id" title="var">x</span>) <span class="id" title="var">q</span> = <span class="id" title="var">q</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Munit_simpl_eq</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">q</span>:<span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) <span class="id" title="var">x</span>, <span class="id" title="var">mu</span> (<span class="id" title="var">Munit</span> <span class="id" title="var">x</span>) <span class="id" title="var">q</span> == <span class="id" title="var">q</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_simpl</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">B</span> → <span class="id" title="var">rat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Mlet</span> <span class="id" title="var">m</span> <span class="id" title="var">M</span>) <span class="id" title="var">f</span> = <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">mu</span> (<span class="id" title="var">M</span> <span class="id" title="var">x</span>) <span class="id" title="var">f</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_simpl_eq</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">B</span> → <span class="id" title="var">rat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Mlet</span> <span class="id" title="var">m</span> <span class="id" title="var">M</span>) <span class="id" title="var">f</span> == <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">mu</span> (<span class="id" title="var">M</span> <span class="id" title="var">x</span>) <span class="id" title="var">f</span>)).<br/>

<br/>
</div>

<div class="doc">
<a name="lab85"></a><h2 class="section">Operations on distributions</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Munit_eq_compat</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>), <span class="id" title="var">x</span> = <span class="id" title="var">y</span> → <span class="id" title="var">Munit</span> <span class="id" title="var">x</span> == <span class="id" title="var">Munit</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_le_compat</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">M1</span> <span class="id" title="var">M2</span> : <span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>), <br/>
&nbsp;&nbsp;(<span class="id" title="var">m1</span> ≤ <span class="id" title="var">m2</span> → <span class="id" title="var">M1</span> ≤ <span class="id" title="var">M2</span> → <span class="id" title="var">Mlet</span> <span class="id" title="var">m1</span> <span class="id" title="var">M1</span> ≤ <span class="id" title="var">Mlet</span> <span class="id" title="var">m2</span> <span class="id" title="var">M2</span>)%<span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Mlet_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">Mlet</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> ==&gt; <span class="id" title="var">Ole</span> ==&gt; <span class="id" title="var">Ole</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Mlet_le_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">Mlet</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span>  <span class="id" title="var">Ole</span> ==&gt; (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">A</span> (<span class="id" title="var">distr</span> <span class="id" title="var">B</span>) (@<span class="id" title="var">Ole</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) ==&gt; <span class="id" title="var">Ole</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Mlet_le_pointwise_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Mlet_mon2</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>), <span class="id" title="var">monotonic2</span> (@<span class="id" title="var">Mlet</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">MLet</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : <span class="id" title="var">distr</span> <span class="id" title="var">A</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>) -<span class="id" title="var">m</span>&gt; <span class="id" title="var">distr</span> <span class="id" title="var">B</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mon2</span> (@<span class="id" title="var">Mlet</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLet_simpl0</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MLet</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">m</span> <span class="id" title="var">M</span> = <span class="id" title="var">Mlet</span> <span class="id" title="var">m</span> <span class="id" title="var">M</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MLet_simpl</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">M</span>:<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">B</span> → <span class="id" title="var">rat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">MLet</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">m</span> <span class="id" title="var">M</span>) <span class="id" title="var">f</span> = <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">mu</span> (<span class="id" title="var">M</span> <span class="id" title="var">x</span>) <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_eq_compat</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">M1</span> <span class="id" title="var">M2</span> : <span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>), <br/>
&nbsp;&nbsp;(<span class="id" title="var">m1</span> == <span class="id" title="var">m2</span> → <span class="id" title="var">M1</span> == <span class="id" title="var">M2</span> → <span class="id" title="var">Mlet</span> <span class="id" title="var">m1</span> <span class="id" title="var">M1</span> == <span class="id" title="var">Mlet</span> <span class="id" title="var">m2</span> <span class="id" title="var">M2</span>)%<span class="id" title="var">type</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Mlet_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">Mlet</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> ==&gt; <span class="id" title="var">Oeq</span> ==&gt; <span class="id" title="var">Oeq</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Mlet_eq_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">Mlet</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span>  <span class="id" title="var">Oeq</span> ==&gt; (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">A</span> (<span class="id" title="var">distr</span> <span class="id" title="var">B</span>) (@<span class="id" title="var">Oeq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) ==&gt; <span class="id" title="var">Oeq</span> <br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">Mlet_Oeq_pointwise_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_le_compat</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">m1</span> ≤ <span class="id" title="var">m2</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>,  <span class="id" title="var">f</span> ≤ <span class="id" title="var">g</span> → <span class="id" title="var">mu</span> <span class="id" title="var">m1</span> <span class="id" title="var">f</span> ≤ <span class="id" title="var">mu</span> <span class="id" title="var">m2</span> <span class="id" title="var">g</span>)%<span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_eq_compat</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="var">m1</span> == <span class="id" title="var">m2</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>,  <span class="id" title="var">f</span> == <span class="id" title="var">g</span> → <span class="id" title="var">mu</span> <span class="id" title="var">m1</span> <span class="id" title="var">f</span> = <span class="id" title="var">mu</span> <span class="id" title="var">m2</span> <span class="id" title="var">g</span>)%<span class="id" title="var">type</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">mu_le_compat</span> <span class="id" title="var">mu_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">mu</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> ==&gt; <span class="id" title="var">Ole</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">mu_le_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">mu</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> ==&gt; <span class="id" title="var">Oeq</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">mu_eq_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) : (@<span class="id" title="var">mu</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">A</span> <span class="id" title="var">rat</span> (@<span class="id" title="var">eq</span> <span class="id" title="var">_</span>) ==&gt; <span class="id" title="var">Oeq</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mu_distr_eq_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) : (@<span class="id" title="var">mu</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">A</span> <span class="id" title="var">rat</span> (@<span class="id" title="var">Oeq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ==&gt; <span class="id" title="var">Oeq</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mu_distr_Oeq_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) : (@<span class="id" title="var">mu</span> <span class="id" title="var">A</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">Ole</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ==&gt; <span class="id" title="var">Ole</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mu_distr_le_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) : (@<span class="id" title="var">Mlet</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">Ole</span> ==&gt; @<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">Ole</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ==&gt; <span class="id" title="var">Ole</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mlet_distr_le_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) : (@<span class="id" title="var">Mlet</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">Oeq</span> ==&gt; @<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (@<span class="id" title="var">Oeq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) ==&gt; <span class="id" title="var">Oeq</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">mlet_distr_eq_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab86"></a><h2 class="section">Properties of monadic operators</h2>

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_unit</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">m</span>:<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>), <span class="id" title="var">Mlet</span> (<span class="id" title="var">Munit</span> <span class="id" title="var">x</span>) <span class="id" title="var">m</span> == <span class="id" title="var">m</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_ext</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>), <span class="id" title="var">Mlet</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">Munit</span> <span class="id" title="var">x</span>) == <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Mlet_assoc</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> (<span class="id" title="var">m1</span>: <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">m2</span>:<span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">B</span>) (<span class="id" title="var">m3</span>:<span class="id" title="var">B</span> → <span class="id" title="var">distr</span> <span class="id" title="var">C</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Mlet</span> (<span class="id" title="var">Mlet</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) <span class="id" title="var">m3</span> == <span class="id" title="var">Mlet</span> <span class="id" title="var">m1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span> ⇒ <span class="id" title="var">Mlet</span> (<span class="id" title="var">m2</span> <span class="id" title="var">x</span>) <span class="id" title="var">m3</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">let_indep</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m1</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">m2</span>: <span class="id" title="var">distr</span> <span class="id" title="var">B</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">MF</span> <span class="id" title="var">B</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">mu</span> <span class="id" title="var">m2</span> <span class="id" title="var">f</span>) = <span class="id" title="var">mu</span> <span class="id" title="var">m2</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">let_indep_distr</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">m1</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">m2</span>: <span class="id" title="var">distr</span> <span class="id" title="var">B</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Mlet</span> <span class="id" title="var">m1</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">m2</span>) == <span class="id" title="var">m2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_le1</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) ≤ 1.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_bool_le1</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_impl</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) ==&gt; (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%<span class="id" title="var">B</span>) → (<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) ≤ <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>))%<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_impl1</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) ==&gt; (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%<span class="id" title="var">B</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 1 →  <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_negb0</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) ==&gt; ~~ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%<span class="id" title="var">B</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 1 →  <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_negb</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (~~ <span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 1 - <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_negb1</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, (~~ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) ==&gt; <span class="id" title="var">g</span> <span class="id" title="var">x</span>)%<span class="id" title="var">B</span>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 0 →  <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>) = 1.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab87"></a><h2 class="section">Distribution for <span class="inlinecode"><span class="id" title="var">flip</span></span></h2>

The distribution associated to <span class="inlinecode"><span class="id" title="var">flip</span></span> <span class="inlinecode">()</span> is 
       <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode">--&gt;</span> <span class="inlinecode">[1/2]</span> <span class="inlinecode">(<a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.5/stdlib/Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)</span> <span class="inlinecode">+</span> <span class="inlinecode">[1/2]</span> <span class="inlinecode">(<a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.5/stdlib/Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)</span> <span class="inlinecode"></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> &quot;[1/2]" := (2%:<span class="id" title="var">Q</span>)^-1.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">flip_mon</span> : <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> : <span class="id" title="var">bool</span> → <span class="id" title="var">rat</span>) ⇒ [1/2] × (<span class="id" title="var">f</span> <span class="id" title="var">true</span>) + [1/2] × (<span class="id" title="var">f</span> <span class="id" title="var">false</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">flip</span> : <span class="id" title="var">M</span> <span class="id" title="var">bool</span> := <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> : <span class="id" title="var">bool</span> → <span class="id" title="var">rat</span>) ⇒ [1/2] × (<span class="id" title="var">f</span> <span class="id" title="var">true</span>) + [1/2] × (<span class="id" title="var">f</span> <span class="id" title="var">false</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">flip_stable_sub</span> : <span class="id" title="var">stable_sub</span> <span class="id" title="var">flip</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">flip_prob</span> : <span class="id" title="var">flip</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ 1) = 1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">flip_true</span> : <span class="id" title="var">flip</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> ⇒ (<span class="id" title="var">b</span>%:<span class="id" title="var">Q</span>)) = [1/2].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">flip_false</span> : <span class="id" title="var">flip</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> ⇒ (~~<span class="id" title="var">b</span>)%:<span class="id" title="var">Q</span>) = [1/2].<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">flip_true</span> <span class="id" title="var">flip_false</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Flip</span>  : <span class="id" title="var">distr</span> <span class="id" title="var">bool</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Flip_simpl</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">f</span>, <span class="id" title="var">mu</span> <span class="id" title="var">Flip</span> <span class="id" title="var">f</span> = [1/2] × (<span class="id" title="var">f</span> <span class="id" title="var">true</span>) + [1/2] × (<span class="id" title="var">f</span> <span class="id" title="var">false</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab88"></a><h2 class="section">Finite distributions given by points and rational coefficients</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="var">Arith</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">rat_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">FiniteDistributions</span>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">p</span> : <span class="id" title="var">seq</span> <span class="id" title="var">A</span>.<br/>

<br/>
</div>

<div class="doc">
We use a finite sequent of points, give a rational coefficient 
    to each point but only consider positive ones 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">weight</span> (<span class="id" title="var">c</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) : <span class="id" title="var">rat</span> := \<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">p</span> | 0 &lt; <span class="id" title="var">c</span> <span class="id" title="var">i</span>) (<span class="id" title="var">c</span> <span class="id" title="var">i</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weight_nonneg</span> <span class="id" title="var">c</span> : 0 ≤ <span class="id" title="var">weight</span> <span class="id" title="var">c</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">weight_nonneg</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weight_case</span> <span class="id" title="var">c</span> : (<span class="id" title="var">weight</span> <span class="id" title="var">c</span> = 0) ∨ 0 &lt; (<span class="id" title="var">weight</span> <span class="id" title="var">c</span>)^-1.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">finite_mon</span> (<span class="id" title="var">c</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) : <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> ⇒ (\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">p</span> | 0 &lt; <span class="id" title="var">c</span> <span class="id" title="var">i</span>) (<span class="id" title="var">c</span> <span class="id" title="var">i</span> × <span class="id" title="var">f</span> <span class="id" title="var">i</span>))/<span class="id" title="var">weight</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mfinite</span> (<span class="id" title="var">c</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) : <span class="id" title="var">M</span> <span class="id" title="var">A</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> ⇒ (\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">p</span> | 0 &lt; <span class="id" title="var">c</span> <span class="id" title="var">i</span>) (<span class="id" title="var">c</span> <span class="id" title="var">i</span> × <span class="id" title="var">f</span> <span class="id" title="var">i</span>))/<span class="id" title="var">weight</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">finite_simpl</span> (<span class="id" title="var">c</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) <span class="id" title="var">f</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mfinite</span> <span class="id" title="var">c</span> <span class="id" title="var">f</span> = (\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">p</span> | 0 &lt; <span class="id" title="var">c</span> <span class="id" title="var">i</span>) (<span class="id" title="var">c</span> <span class="id" title="var">i</span> × <span class="id" title="var">f</span> <span class="id" title="var">i</span>))/<span class="id" title="var">weight</span> <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">finite_stable_sub</span> (<span class="id" title="var">c</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) : <span class="id" title="var">stable_sub</span> (<span class="id" title="var">mfinite</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">FiniteDistributions</span>.<br/>

<br/>
</div>

<div class="doc">
We have a distribution when the total weight is positive 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">fin</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <span class="id" title="var">mkfin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">points</span> : <span class="id" title="var">seq</span> <span class="id" title="var">A</span>; <span class="id" title="var">coeff</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>; <span class="id" title="var">weight_pos</span> : 0 &lt; <span class="id" title="var">weight</span> <span class="id" title="var">points</span> <span class="id" title="var">coeff</span>}.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">weight_pos</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inv_weight_pos</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>) : 0 &lt; (<span class="id" title="var">weight</span> (<span class="id" title="var">points</span> <span class="id" title="var">d</span>) (<span class="id" title="var">coeff</span> <span class="id" title="var">d</span>))^-1.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">inv_weight_pos</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weight_is_unit</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>) : (<span class="id" title="var">weight</span> (<span class="id" title="var">points</span> <span class="id" title="var">d</span>) (<span class="id" title="var">coeff</span> <span class="id" title="var">d</span>)) \<span class="id" title="var">is</span> <span class="id" title="var">a</span> <span class="id" title="var">unit</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">weight_is_unit</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fprob</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) : <span class="id" title="var">rat</span> := <span class="id" title="var">coeff</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> / <span class="id" title="var">weight</span> (<span class="id" title="var">points</span> <span class="id" title="var">d</span>) (<span class="id" title="var">coeff</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Finite</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span>,  <span class="id" title="var">fin</span> <span class="id" title="var">A</span> → <span class="id" title="var">distr</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Finite_simpl</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Finite</span> <span class="id" title="var">d</span>) = <span class="id" title="var">mfinite</span> (<span class="id" title="var">points</span> <span class="id" title="var">d</span>) (<span class="id" title="var">coeff</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Finite_eq_in</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">uniq</span> (<span class="id" title="var">points</span> <span class="id" title="var">d</span>) → (<span class="id" title="var">a</span> \<span class="id" title="keyword">in</span> <span class="id" title="var">points</span> <span class="id" title="var">d</span>)%<span class="id" title="var">SEQ</span> → 0 &lt; <span class="id" title="var">coeff</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Finite</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span>==<span class="id" title="var">a</span>)%:<span class="id" title="var">Q</span>) = <span class="id" title="var">fprob</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Finite_eq_out</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> \<span class="id" title="var">notin</span> <span class="id" title="var">points</span> <span class="id" title="var">d</span>)%<span class="id" title="var">SEQ</span> ∨ (<span class="id" title="var">coeff</span> <span class="id" title="var">d</span> <span class="id" title="var">a</span> ≤ 0)%<span class="id" title="var">Q</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Finite</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span>==<span class="id" title="var">a</span>)%:<span class="id" title="var">Q</span>) = 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Finite_in_seq</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d</span>:<span class="id" title="var">fin</span> <span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Finite</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span> \<span class="id" title="keyword">in</span> <span class="id" title="var">points</span> <span class="id" title="var">d</span>)%:<span class="id" title="var">Q</span>) = 1%<span class="id" title="var">R</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab89"></a><h2 class="section">Uniform distribution on a non empty sequence of points</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">unif</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : <span class="id" title="keyword">Type</span> := <span class="id" title="var">mkunif</span> <br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="var">upoints</span> :&gt; <span class="id" title="var">seq</span> <span class="id" title="var">A</span>; <span class="id" title="var">_</span> : <span class="id" title="var">size</span> <span class="id" title="var">upoints</span>!=<span class="id" title="var">O</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">usize</span> <span class="id" title="var">A</span> (<span class="id" title="var">p</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <span class="id" title="var">nat</span> := <span class="id" title="var">size</span> (<span class="id" title="var">upoints</span> <span class="id" title="var">p</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">usize_pos</span> <span class="id" title="var">A</span> (<span class="id" title="var">p</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <span class="id" title="var">usize</span> <span class="id" title="var">p</span> != <span class="id" title="var">O</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unif2fin</span> <span class="id" title="var">A</span> (<span class="id" title="var">p</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <span class="id" title="var">fin</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Uniform</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <span class="id" title="var">distr</span> <span class="id" title="var">A</span> := <span class="id" title="var">Finite</span> (<span class="id" title="var">unif2fin</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Uniform_simpl</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <span class="id" title="var">mu</span> (<span class="id" title="var">Uniform</span> <span class="id" title="var">d</span>) = <span class="id" title="var">mfinite</span> (<span class="id" title="var">upoints</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">A</span> ⇒ 1%<span class="id" title="var">Q</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">weight1_size</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">seq</span> <span class="id" title="var">A</span>) : <span class="id" title="var">weight</span> <span class="id" title="var">d</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ 1) = (<span class="id" title="var">size</span> <span class="id" title="var">d</span>)%:<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_uniform_sum</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">A</span>→<span class="id" title="var">rat</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Uniform</span> <span class="id" title="var">d</span>) <span class="id" title="var">f</span> = (\<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">d</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span>) / (<span class="id" title="var">size</span> <span class="id" title="var">d</span>)%:<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Uniform_eq_in</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) : <span class="id" title="var">uniq</span> <span class="id" title="var">d</span> → (<span class="id" title="var">a</span> \<span class="id" title="keyword">in</span> <span class="id" title="var">upoints</span> <span class="id" title="var">d</span>)%<span class="id" title="var">SEQ</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Uniform</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span>==<span class="id" title="var">a</span>)%:<span class="id" title="var">Q</span>) = 1%:<span class="id" title="var">Q</span> / (<span class="id" title="var">usize</span> <span class="id" title="var">d</span>)%:<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Uniform_eq_out</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">a</span> \<span class="id" title="var">notin</span> <span class="id" title="var">upoints</span> <span class="id" title="var">d</span>)%<span class="id" title="var">SEQ</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Uniform</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span>==<span class="id" title="var">a</span>)%:<span class="id" title="var">Q</span>) = 0%<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Uniform_in_seq</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d</span>:<span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Uniform</span> <span class="id" title="var">d</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span> \<span class="id" title="keyword">in</span> <span class="id" title="var">upoints</span> <span class="id" title="var">d</span>)%:<span class="id" title="var">Q</span>) = 1%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <span class="id" title="var">succ_neq0</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span>, (<span class="id" title="var">n</span>==<span class="id" title="var">m</span>.+1)%<span class="id" title="var">N</span> → (<span class="id" title="var">n</span>!=0)%<span class="id" title="var">N</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Uniform_unif_seq_eq</span> (<span class="id" title="var">A</span>:<span class="id" title="var">eqType</span>) (<span class="id" title="var">d1</span> <span class="id" title="var">d2</span> : <span class="id" title="var">unif</span> <span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">d1</span> == <span class="id" title="var">d2</span> :&gt; <span class="id" title="var">seq</span> <span class="id" title="var">A</span>) → <span class="id" title="var">Uniform</span> <span class="id" title="var">d1</span> == <span class="id" title="var">Uniform</span> <span class="id" title="var">d2</span>.<br/>

<br/>
</div>

<div class="doc">
Uniform distribution on a sequence with a default value 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unif_def</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">s</span>:<span class="id" title="var">seq</span> <span class="id" title="var">A</span>) : <span class="id" title="var">unif</span> <span class="id" title="var">A</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Uniform_def_ne</span> <span class="id" title="var">A</span> (<span class="id" title="var">d</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">s</span>:<span class="id" title="var">seq</span> <span class="id" title="var">A</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">Hs</span>:(<span class="id" title="var">size</span> <span class="id" title="var">s</span> != 0)%<span class="id" title="var">N</span>), <span class="id" title="var">Uniform</span> (<span class="id" title="var">unif_def</span> <span class="id" title="var">d</span> <span class="id" title="var">s</span>) = <span class="id" title="var">Uniform</span> (<span class="id" title="var">mkunif</span> <span class="id" title="var">s</span> <span class="id" title="var">Hs</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">unifnat</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">unif</span> <span class="id" title="var">nat</span> := <span class="id" title="var">mkunif</span> (<span class="id" title="keyword">iota</span> 0 (<span class="id" title="var">n</span>.+1)) (<span class="id" title="var">eq_refl</span> <span class="id" title="var">true</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Random</span> <span class="id" title="var">n</span> : <span class="id" title="var">distr</span> <span class="id" title="var">nat</span> := <span class="id" title="var">Uniform</span> (<span class="id" title="var">unifnat</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Random_simpl</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">mu</span> (<span class="id" title="var">Random</span> <span class="id" title="var">n</span>) = <span class="id" title="var">mfinite</span> (<span class="id" title="keyword">iota</span> 0 (<span class="id" title="var">n</span>.+1)) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ 1%:<span class="id" title="var">Q</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Random_eq_in</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>) : (<span class="id" title="var">a</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Random</span> <span class="id" title="var">n</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span>==<span class="id" title="var">a</span>)%:<span class="id" title="var">Q</span>) = 1%:<span class="id" title="var">Q</span> / (<span class="id" title="var">n</span>.+1)%:<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Random_eq_out</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">nat</span>) : (<span class="id" title="var">n</span> &lt; <span class="id" title="var">a</span>)%<span class="id" title="var">N</span> → <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Random</span> <span class="id" title="var">n</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span>==<span class="id" title="var">a</span>)%:<span class="id" title="var">Q</span>) = 0%<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_random_sum</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">rat</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Random</span> <span class="id" title="var">n</span>) <span class="id" title="var">f</span> = (\<span class="id" title="var">sum_</span>(0 ≤ <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span>.+1) <span class="id" title="var">f</span> <span class="id" title="var">i</span>) / (<span class="id" title="var">n</span>.+1)%:<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Random_in_range</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mu</span> (<span class="id" title="var">Random</span> <span class="id" title="var">n</span>) (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span> ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span>%:<span class="id" title="var">Q</span>) = 1%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_0le</span> <span class="id" title="var">A</span> (<span class="id" title="var">m</span>:<span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">A</span>→<span class="id" title="var">bool</span>) : 0 ≤ <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">mu_bool_0le</span>.<br/>

<br/>
<span class="id" title="keyword">Local Close</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">rat_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">rat_coerce</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_stable_sum</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">I</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">I</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">I</span> → <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> ⇒ \<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span>) <span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="var">a</span>) = \<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span>) (<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="var">f</span> <span class="id" title="var">i</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_seq_sum</span> (<span class="id" title="var">A</span> : <span class="id" title="var">eqType</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">A</span>) <span class="id" title="var">x</span> :<br/>
&nbsp;&nbsp;<span class="id" title="var">uniq</span> <span class="id" title="var">s</span> → (<span class="id" title="var">x</span> \<span class="id" title="keyword">in</span> <span class="id" title="var">s</span>)%:<span class="id" title="var">Q</span> = \<span class="id" title="var">sum_</span>(<span class="id" title="var">i</span> &lt;- <span class="id" title="var">s</span>) (<span class="id" title="var">x</span> == <span class="id" title="var">i</span>)%:<span class="id" title="var">Q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_in_seq</span> (<span class="id" title="var">A</span> : <span class="id" title="var">eqType</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">seq</span> <span class="id" title="var">A</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">uniq</span> <span class="id" title="var">s</span> →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span> \<span class="id" title="keyword">in</span> <span class="id" title="var">s</span>)) = \<span class="id" title="var">sum_</span>(<span class="id" title="var">a</span> &lt;- <span class="id" title="var">s</span>) <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">x</span> == <span class="id" title="var">a</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_bool_cond</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">bool</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) = 1 →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)) = <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span> &amp;&amp; <span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mu_pos_cond</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">distr</span> <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">bool</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">A</span> → <span class="id" title="var">rat</span>) :<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, 0 ≤ <span class="id" title="var">g</span> <span class="id" title="var">x</span> ≤ 1) →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) = 1 →<br/>
&nbsp;&nbsp;<span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)) = <span class="id" title="var">mu</span> <span class="id" title="var">m</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ ((<span class="id" title="var">f</span> <span class="id" title="var">x</span>)%:<span class="id" title="var">Q</span> × <span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>