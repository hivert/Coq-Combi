<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>ALEA.Misc</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ALEA.Misc</h1>

<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab153"></a><h1 class="section">Misc.v: Preliminaries</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Arith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Classes.SetoidTactics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Classes.SetoidClass</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Coq.Classes.Morphisms</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Local</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">signature_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">beq_nat_neq</span>: <span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">x</span> ≠ <span class="id" title="var">y</span> &rarr; <span class="id" title="var">false</span> = <span class="id" title="var">beq_nat</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">if_beq_nat_nat_eq_dec</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span>:<span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">if</span> <span class="id" title="var">beq_nat</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="keyword">then</span> <span class="id" title="var">a</span> <span class="id" title="keyword">else</span> <span class="id" title="var">b</span>) = <span class="id" title="keyword">if</span> <span class="id" title="var">eq_nat_dec</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="keyword">then</span> <span class="id" title="var">a</span> <span class="id" title="keyword">else</span> <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ifte</span> <span class="id" title="var">A</span> (<span class="id" title="var">test</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">thn</span> <span class="id" title="var">els</span>:<span class="id" title="var">A</span>) := <span class="id" title="keyword">if</span> <span class="id" title="var">test</span> <span class="id" title="keyword">then</span> <span class="id" title="var">thn</span> <span class="id" title="keyword">else</span> <span class="id" title="var">els</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) : (@<span class="id" title="var">ifte</span> <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">eq</span> &rArr;<span class="id" title="var">eq</span> &rArr; <span class="id" title="var">eq</span> &rArr; <span class="id" title="var">eq</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ifte_morphism1</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) <span class="id" title="var">x</span> : (@<span class="id" title="var">ifte</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">eq</span> &rArr; <span class="id" title="var">eq</span> &rArr; <span class="id" title="var">eq</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ifte_morphism2</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span> : (@<span class="id" title="var">ifte</span> <span class="id" title="var">A</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">eq</span> &rArr; <span class="id" title="var">eq</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">ifte_morphism3</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab154"></a><h2 class="section">Definition of iterator <span class="inlinecode"><span class="id" title="var">compn</span></span></h2>

   <span class="inlinecode"><span class="id" title="var">compn</span></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.plactic.html#IncrMap.u"><span class="id" title="variable">u</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.MPoly.sympoly.html#RatToAlgC.n"><span class="id" title="variable">n</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a></span> is defined as (f (u (n-1)).. (f (u 0) x)) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compn</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">u</span>:<span class="id" title="var">nat</span> &rarr; <span class="id" title="var">A</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">n</span>}: <span class="id" title="var">A</span> := <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> <span class="id" title="var">O</span> &rArr; <span class="id" title="var">x</span> | (<span class="id" title="var">S</span> <span class="id" title="var">p</span>) &rArr; <span class="id" title="var">f</span> (<span class="id" title="var">u</span> <span class="id" title="var">p</span>) (<span class="id" title="var">compn</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">u</span> <span class="id" title="var">p</span>) <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp0</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">u</span>:<span class="id" title="var">nat</span> &rarr; <span class="id" title="var">A</span>), <span class="id" title="var">compn</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">u</span> 0 = <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compS</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) (<span class="id" title="var">u</span>:<span class="id" title="var">nat</span> &rarr; <span class="id" title="var">A</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compn</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">u</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">u</span> <span class="id" title="var">n</span>) (<span class="id" title="var">compn</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">u</span> <span class="id" title="var">n</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab155"></a><h2 class="section">Reducing if constructs</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">if_then</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">P</span>:<span class="id" title="keyword">Prop</span>) (<span class="id" title="var">b</span>:{ <span class="id" title="var">P</span> }+{ &not; <span class="id" title="var">P</span> })(<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">P</span> &rarr; (<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">p</span> <span class="id" title="keyword">else</span> <span class="id" title="var">q</span>) = <span class="id" title="var">p</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">if_else</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">P</span> :<span class="id" title="keyword">Prop</span>) (<span class="id" title="var">b</span>:{ <span class="id" title="var">P</span> }+{ &not; <span class="id" title="var">P</span> })(<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&not;<span class="id" title="var">P</span> &rarr; (<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">p</span> <span class="id" title="keyword">else</span> <span class="id" title="var">q</span>) = <span class="id" title="var">q</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">if_then_not</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span>:<span class="id" title="keyword">Prop</span>) (<span class="id" title="var">b</span>:{ <span class="id" title="var">P</span> }+{ <span class="id" title="var">Q</span> })(<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&not; <span class="id" title="var">Q</span> &rarr; (<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">p</span> <span class="id" title="keyword">else</span> <span class="id" title="var">q</span>) = <span class="id" title="var">p</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">if_else_not</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">P</span> <span class="id" title="var">Q</span>:<span class="id" title="keyword">Prop</span>) (<span class="id" title="var">b</span>:{ <span class="id" title="var">P</span> }+{ <span class="id" title="var">Q</span> })(<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">A</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&not;<span class="id" title="var">P</span> &rarr; (<span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">p</span> <span class="id" title="keyword">else</span> <span class="id" title="var">q</span>) = <span class="id" title="var">q</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab156"></a><h2 class="section">Classical reasoning</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">class</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Prop</span>) := &not; &not; <span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">class_neg</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span>:<span class="id" title="keyword">Prop</span>, <span class="id" title="var">class</span> ( &not; <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">class_false</span> : <span class="id" title="var">class</span> <span class="id" title="var">False</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">class_neg</span> <span class="id" title="var">class_false</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">orc</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Prop</span>) := <span class="id" title="keyword">&forall;</span> <span class="id" title="var">C</span>:<span class="id" title="keyword">Prop</span>, <span class="id" title="var">class</span> <span class="id" title="var">C</span> &rarr; (<span class="id" title="var">A</span> &rarr; <span class="id" title="var">C</span>) &rarr; (<span class="id" title="var">B</span> &rarr; <span class="id" title="var">C</span>) &rarr; <span class="id" title="var">C</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">orc_left</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Prop</span>, <span class="id" title="var">A</span> &rarr; <span class="id" title="var">orc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">orc_right</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>:<span class="id" title="keyword">Prop</span>, <span class="id" title="var">B</span> &rarr; <span class="id" title="var">orc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">orc_left</span> <span class="id" title="var">orc_right</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">class_orc</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">class</span> (<span class="id" title="var">orc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">class_orc</span> [].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">orc_intro</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, ( &not; <span class="id" title="var">A</span> &rarr; &not; <span class="id" title="var">B</span> &rarr; <span class="id" title="var">False</span>) &rarr; <span class="id" title="var">orc</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">class_and</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, <span class="id" title="var">class</span> <span class="id" title="var">A</span> &rarr; <span class="id" title="var">class</span> <span class="id" title="var">B</span> &rarr; <span class="id" title="var">class</span> (<span class="id" title="var">A</span> &and; <span class="id" title="var">B</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">excluded_middle</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span>, <span class="id" title="var">orc</span> <span class="id" title="var">A</span> ( &not; <span class="id" title="var">A</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">exc</span> (<span class="id" title="var">A</span> :<span class="id" title="keyword">Type</span>)(<span class="id" title="var">P</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="keyword">Prop</span>) := <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">&forall;</span> <span class="id" title="var">C</span>:<span class="id" title="keyword">Prop</span>, <span class="id" title="var">class</span> <span class="id" title="var">C</span> &rarr; (<span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> &rarr; <span class="id" title="var">C</span>) &rarr; <span class="id" title="var">C</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">exc_intro</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">A</span> :<span class="id" title="keyword">Type</span>)(<span class="id" title="var">P</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>), <span class="id" title="var">P</span> <span class="id" title="var">x</span> &rarr; <span class="id" title="var">exc</span> <span class="id" title="var">P</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">class_exc</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">A</span> :<span class="id" title="keyword">Type</span>)(<span class="id" title="var">P</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="keyword">Prop</span>), <span class="id" title="var">class</span> (<span class="id" title="var">exc</span> <span class="id" title="var">P</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">exc_intro_class</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">P</span>:<span class="id" title="var">A</span> &rarr; <span class="id" title="keyword">Prop</span>), ((<span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span>, &not; <span class="id" title="var">P</span> <span class="id" title="var">x</span>) &rarr; <span class="id" title="var">False</span>) &rarr; <span class="id" title="var">exc</span> <span class="id" title="var">P</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_and_elim_left</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, &not; (<span class="id" title="var">A</span> &and; <span class="id" title="var">B</span>) &rarr; <span class="id" title="var">A</span> &rarr; &not;<span class="id" title="var">B</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_and_elim_right</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>, &not; (<span class="id" title="var">A</span> &and; <span class="id" title="var">B</span>) &rarr; <span class="id" title="var">B</span> &rarr; &not;<span class="id" title="var">A</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">class_orc</span> <span class="id" title="var">class_and</span> <span class="id" title="var">class_exc</span> <span class="id" title="var">excluded_middle</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">class_double_neg</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span>: <span class="id" title="keyword">Prop</span>, <span class="id" title="var">class</span> <span class="id" title="var">Q</span> &rarr; (<span class="id" title="var">P</span> &rarr; <span class="id" title="var">Q</span>) &rarr; &not; &not; <span class="id" title="var">P</span> &rarr; <span class="id" title="var">Q</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab157"></a><h2 class="section">Extensional equality</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">feq</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> &rarr; <span class="id" title="var">B</span>) := <span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">feq_refl</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span>:<span class="id" title="var">A</span>&rarr;<span class="id" title="var">B</span>), <span class="id" title="var">feq</span> <span class="id" title="var">f</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">feq_sym</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">A</span> &rarr; <span class="id" title="var">B</span>), <span class="id" title="var">feq</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> &rarr; <span class="id" title="var">feq</span> <span class="id" title="var">g</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">feq_trans</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span>: <span class="id" title="var">A</span> &rarr; <span class="id" title="var">B</span>), <span class="id" title="var">feq</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> &rarr; <span class="id" title="var">feq</span> <span class="id" title="var">g</span> <span class="id" title="var">h</span> &rarr; <span class="id" title="var">feq</span> <span class="id" title="var">f</span> <span class="id" title="var">h</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">feq_refl</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">feq_sym</span>.<br/>
<span class="id" title="keyword">Hint Unfold</span> <span class="id" title="var">feq</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Relation</span> (<span class="id" title="var">A</span> <span class="id" title="var">B</span> : <span class="id" title="keyword">Type</span>) : (<span class="id" title="var">A</span> &rarr; <span class="id" title="var">B</span>) (<span class="id" title="var">feq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>)) <br/>
&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span> <span class="id" title="var">proved</span> <span class="id" title="tactic">by</span> (<span class="id" title="var">feq_refl</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span> <span class="id" title="var">proved</span> <span class="id" title="tactic">by</span> (<span class="id" title="var">feq_sym</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
&nbsp;&nbsp;<span class="id" title="tactic">transitivity</span> <span class="id" title="var">proved</span> <span class="id" title="tactic">by</span> (<span class="id" title="var">feq_trans</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">B</span>:=<span class="id" title="var">B</span>))<br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">feq_rel</span>.<br/>

<br/>
</div>

<div class="doc">
Computational version of elimination on CompSpec 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">CompSpec_rect</span> : <span class="id" title="keyword">&forall;</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">eq</span> <span class="id" title="var">lt</span> : <span class="id" title="var">A</span> &rarr; <span class="id" title="var">A</span> &rarr; <span class="id" title="keyword">Prop</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P</span> : <span class="id" title="var">comparison</span> &rarr; <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> &rarr; <span class="id" title="var">P</span> <span class="id" title="var">Eq</span>) &rarr;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> &rarr; <span class="id" title="var">P</span> <span class="id" title="var">Lt</span>) &rarr;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lt</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> &rarr; <span class="id" title="var">P</span> <span class="id" title="var">Gt</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&rarr; <span class="id" title="keyword">&forall;</span> <span class="id" title="var">c</span> : <span class="id" title="var">comparison</span>, <span class="id" title="var">CompSpec</span> <span class="id" title="var">eq</span> <span class="id" title="var">lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">c</span> &rarr; <span class="id" title="var">P</span> <span class="id" title="var">c</span>.<br/>

<br/>
</div>

<div class="doc">
Decidability 
</div>
<div class="code">
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Omega</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dec_sig_lt</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> &rarr; <span class="id" title="keyword">Prop</span>, (<span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span>, {<span class="id" title="var">P</span> <span class="id" title="var">x</span>}+{ &not; <span class="id" title="var">P</span> <span class="id" title="var">x</span>})<br/>
&nbsp;&nbsp;&rarr; <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span>, {<span class="id" title="var">i</span> | <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> &and; <span class="id" title="var">P</span> <span class="id" title="var">i</span>}+{<span class="id" title="keyword">&forall;</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> &rarr; &not; <span class="id" title="var">P</span> <span class="id" title="var">i</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">dec_exists_lt</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">P</span> : <span class="id" title="var">nat</span> &rarr; <span class="id" title="keyword">Prop</span>, (<span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span>, {<span class="id" title="var">P</span> <span class="id" title="var">x</span>}+{ &not; <span class="id" title="var">P</span> <span class="id" title="var">x</span>})<br/>
&nbsp;&nbsp;&rarr; <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span>, {<span class="id" title="tactic">∃</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> &and; <span class="id" title="var">P</span> <span class="id" title="var">i</span>}+{~ <span class="id" title="tactic">∃</span> <span class="id" title="var">i</span>, <span class="id" title="var">i</span> &lt; <span class="id" title="var">n</span> &and; <span class="id" title="var">P</span> <span class="id" title="var">i</span>}.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_nat2_dec</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">nat</span>×<span class="id" title="var">nat</span>, { <span class="id" title="var">p</span>=<span class="id" title="var">q</span> }+{~ <span class="id" title="var">p</span>=<span class="id" title="var">q</span> }.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_compare_specT</span> <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">&forall;</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">nat</span>, <span class="id" title="var">CompareSpecT</span> (<span class="id" title="var">x</span> = <span class="id" title="var">y</span>) (<span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>)%<span class="id" title="var">nat</span> (<span class="id" title="var">y</span> &lt; <span class="id" title="var">x</span>)%<span class="id" title="var">nat</span> (<span class="id" title="var">nat_compare</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab158"></a><h1 class="section">Preliminary lemmas relating the ordre on nat and N</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">NArith</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">N2Nat_lt_mono</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, (<span class="id" title="var">n</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> &harr; (<span class="id" title="var">N.to_nat</span> <span class="id" title="var">n</span> &lt; <span class="id" title="var">N.to_nat</span> <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">N2Nat_le_mono</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> &harr; (<span class="id" title="var">N.to_nat</span> <span class="id" title="var">n</span> ≤ <span class="id" title="var">N.to_nat</span> <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">N2Nat_inj_lt</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, (<span class="id" title="var">n</span> &lt; <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> &rarr; (<span class="id" title="var">N.to_nat</span> <span class="id" title="var">n</span> &lt; <span class="id" title="var">N.to_nat</span> <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">N2Nat_inj_le</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, (<span class="id" title="var">n</span> ≤ <span class="id" title="var">m</span>)%<span class="id" title="var">N</span> &rarr; (<span class="id" title="var">N.to_nat</span> <span class="id" title="var">n</span> ≤ <span class="id" title="var">N.to_nat</span> <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">N2Nat_inj_pos</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span>, (0 &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> &rarr; (0 &lt; <span class="id" title="var">N.to_nat</span> <span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">N2Nat_inj_lt</span> <span class="id" title="var">N2Nat_inj_pos</span> <span class="id" title="var">N2Nat_inj_le</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Nsucc_pred_pos</span>: <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span> : <span class="id" title="var">N</span>, (0 &lt; <span class="id" title="var">n</span>)%<span class="id" title="var">N</span> &rarr; <span class="id" title="var">N.succ</span> (<span class="id" title="var">N.pred</span> <span class="id" title="var">n</span>) = <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Nsucc_pred_pos</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Npos</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span>, (0 ≤ <span class="id" title="var">n</span>)%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Npos</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Neq_lt_0</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span>, (<span class="id" title="var">n</span>=0)%<span class="id" title="var">N</span> &or; (0&lt;<span class="id" title="var">n</span>)%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">Neq_lt_0</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Nlt0_le1</span> : <span class="id" title="keyword">&forall;</span> <span class="id" title="var">n</span>, (0&lt;<span class="id" title="var">n</span>)%<span class="id" title="var">N</span> &rarr; (1&lt;=<span class="id" title="var">n</span>)%<span class="id" title="var">N</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">Nlt0_le1</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">Nineq</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- (<span class="id" title="var">N.le</span> ?<span class="id" title="var">n</span> ?<span class="id" title="var">m</span>) &rArr; <span class="id" title="tactic">compute</span>; <span class="id" title="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- (<span class="id" title="var">N.lt</span> ?<span class="id" title="var">n</span> ?<span class="id" title="var">m</span>) &rArr; <span class="id" title="tactic">compute</span>; <span class="id" title="tactic">reflexivity</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- &not; (<span class="id" title="var">eq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">N</span>) ?<span class="id" title="var">n</span> ?<span class="id" title="var">m</span>) &rArr; <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">N.compare_eq_iff</span>; <span class="id" title="tactic">compute</span>; <span class="id" title="tactic">discriminate</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>