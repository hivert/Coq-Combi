<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>ALEA.Ccpo</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library ALEA.Ccpo</h1>

<div class="code">
</div>

<div class="doc">
<a name="lab125"></a><h1 class="section">Ccpo.v: Specification and properties of a cpo</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Arith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Omega</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Classes.SetoidTactics</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Classes.SetoidClass</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Coq.Classes.Morphisms</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Local</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">signature_scope</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">O_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">O_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab126"></a><h2 class="section">Ordered type</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_rel</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">E1</span> <span class="id" title="var">E2</span>:<span class="id" title="var">relation</span> <span class="id" title="var">A</span>) := <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">E1</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ↔ <span class="id" title="var">E2</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">Order</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">E</span>:<span class="id" title="var">relation</span> <span class="id" title="var">A</span>)  (<span class="id" title="var">R</span>:<span class="id" title="var">relation</span> <span class="id" title="var">A</span>) := <br/>
&nbsp;&nbsp;{<span class="id" title="var">reflexive</span> :&gt; <span class="id" title="var">Reflexive</span> <span class="id" title="var">R</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">order_eq</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ∧ <span class="id" title="var">R</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> ↔ <span class="id" title="var">E</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">transitive</span> :&gt; <span class="id" title="var">Transitive</span> <span class="id" title="var">R</span> }.<br/>

<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">OrderEqRefl</span> `{<span class="id" title="var">Order</span> <span class="id" title="var">A</span> <span class="id" title="var">E</span> <span class="id" title="var">R</span>} : <span class="id" title="var">Reflexive</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">OrderEqSym</span> `{<span class="id" title="var">Order</span> <span class="id" title="var">A</span> <span class="id" title="var">E</span> <span class="id" title="var">R</span>} : <span class="id" title="var">Symmetric</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">OrderEqTrans</span> `{<span class="id" title="var">Order</span> <span class="id" title="var">A</span> <span class="id" title="var">E</span> <span class="id" title="var">R</span>} : <span class="id" title="var">Transitive</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">OrderEquiv</span> `{<span class="id" title="var">Order</span> <span class="id" title="var">A</span> <span class="id" title="var">E</span> <span class="id" title="var">R</span>} : <span class="id" title="var">Equivalence</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Opaque</span> <span class="id" title="var">OrderEquiv</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">ord</span> <span class="id" title="var">A</span> := <br/>
&nbsp;&nbsp;&nbsp;{  <span class="id" title="var">Oeq</span> : <span class="id" title="var">relation</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ole</span> : <span class="id" title="var">relation</span> <span class="id" title="var">A</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">order_rel</span> :&gt; <span class="id" title="var">Order</span> <span class="id" title="var">Oeq</span> <span class="id" title="var">Ole</span> }.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">OrdSetoid</span> `(<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>) : <span class="id" title="var">Setoid</span> <span class="id" title="var">A</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Relation</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="var">A</span> (@<span class="id" title="var">Oeq</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>) <br/>
<span class="id" title="tactic">reflexivity</span> <span class="id" title="var">proved</span>  <span class="id" title="tactic">by</span> <span class="id" title="var">OrderEqRefl</span><br/>
<span class="id" title="tactic">symmetry</span> <span class="id" title="var">proved</span>  <span class="id" title="tactic">by</span> <span class="id" title="var">OrderEqSym</span><br/>
<span class="id" title="tactic">transitivity</span> <span class="id" title="var">proved</span> <span class="id" title="tactic">by</span> <span class="id" title="var">OrderEqTrans</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">Oeq_setoid</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;&lt;=" := <span class="id" title="var">Ole</span> : <span class="id" title="var">O_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;==" := <span class="id" title="var">Oeq</span> : <span class="id" title="var">type_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Oge</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} := <span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>) ⇒ <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;&gt;=" := <span class="id" title="var">Oge</span> : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_refl_eq</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">Ole_refl_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_refl_eq_inv</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">Ole_refl_eq_inv</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_trans</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">z</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_refl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &le;  <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Ole_refl</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Relation</span> {<span class="id" title="var">A</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="var">A</span> (@<span class="id" title="var">Ole</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>) <br/>
<span class="id" title="tactic">reflexivity</span> <span class="id" title="var">proved</span>  <span class="id" title="tactic">by</span> <span class="id" title="var">Ole_refl</span><br/>
<span class="id" title="tactic">transitivity</span> <span class="id" title="var">proved</span> <span class="id" title="tactic">by</span> <span class="id" title="var">Ole_trans</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">Ole_setoid</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_antisym</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">Ole_antisym</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Oeq_refl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Oeq_refl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Oeq_refl_eq</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span> = <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Oeq_refl_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Oeq_sym</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Oeq_le</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Oeq_le_sym</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Oeq_le</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">Oeq_sym</span> @<span class="id" title="var">Oeq_le_sym</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Oeq_trans</span> <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<span class="id" title="var">O</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">z</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">z</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Oeq_trans</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `(<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>): (<span class="id" title="var">Ole</span> (<span class="id" title="var">ord</span>:=<span class="id" title="var">o</span>)) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">Oeq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) ==&gt; <span class="id" title="var">Oeq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) ==&gt; <span class="id" title="var">iff</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Ole_eq_compat_iff</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
</div>

<div class="doc">
Equivalence of orders 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_ord</span> {<span class="id" title="var">O</span>} (<span class="id" title="var">o1</span> <span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) := <span class="id" title="var">eq_rel</span> (<span class="id" title="var">Ole</span> (<span class="id" title="var">ord</span>:=<span class="id" title="var">o1</span>)) (<span class="id" title="var">Ole</span> (<span class="id" title="var">ord</span>:=<span class="id" title="var">o2</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_ord_equiv</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} (<span class="id" title="var">o1</span> <span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>), <span class="id" title="var">eq_ord</span> <span class="id" title="var">o1</span> <span class="id" title="var">o2</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_rel</span> (<span class="id" title="var">Oeq</span> (<span class="id" title="var">ord</span>:=<span class="id" title="var">o1</span>)) (<span class="id" title="var">Oeq</span> (<span class="id" title="var">ord</span>:=<span class="id" title="var">o2</span>)).<br/>

<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_eq_compat</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x1</span>  &asymp;  <span class="id" title="var">x2</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">x3</span> <span class="id" title="var">x4</span> : <span class="id" title="var">O</span>, <span class="id" title="var">x3</span>  &asymp;  <span class="id" title="var">x4</span> → <span class="id" title="var">x1</span>  &le;  <span class="id" title="var">x3</span> → <span class="id" title="var">x2</span>  &le;  <span class="id" title="var">x4</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_eq_right</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>: <span class="id" title="var">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">z</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_eq_left</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>: <span class="id" title="var">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">z</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : (<span class="id" title="var">Oeq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702;  <span class="id" title="var">iff</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Oeq_iff_morphism</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : (<span class="id" title="var">Ole</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702;  <span class="id" title="var">iff</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Ole_iff_morphism</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : (<span class="id" title="var">Ole</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> --&gt; <span class="id" title="var">Ole</span> &#8702;  <span class="id" title="var">Basics.impl</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Ole_impl_morphism</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab127"></a><h2 class="section">Definition and properties of <span class="inlinecode"></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene_inv.html#SetContainingBothLeft.Case.y"><span class="id" title="variable">y</span></a></span> <span class="inlinecode"></span></h2>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Olt</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} (<span class="id" title="var">r1</span> <span class="id" title="var">r2</span>:<span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> := (<span class="id" title="var">r1</span>  &le;  <span class="id" title="var">r2</span>) ∧ ¬ (<span class="id" title="var">r1</span>  &asymp;  <span class="id" title="var">r2</span>).<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;&lt;" := <span class="id" title="var">Olt</span> : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_eq_compat</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} :<br/>
<span class="id" title="keyword">∀</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x1</span>  &asymp;  <span class="id" title="var">x2</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">x3</span> <span class="id" title="var">x4</span> : <span class="id" title="var">A</span>, <span class="id" title="var">x3</span>  &asymp;  <span class="id" title="var">x4</span> → <span class="id" title="var">x1</span> &lt; <span class="id" title="var">x3</span> → <span class="id" title="var">x2</span> &lt; <span class="id" title="var">x4</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : (<span class="id" title="var">Olt</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>))<br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">iff</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Olt_iff_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_neq</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">A</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → ¬ <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_neq_rev</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">A</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → ¬ <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_le</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_notle</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → ¬ <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_trans</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<span class="id" title="var">A</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → <span class="id" title="var">y</span> &lt; <span class="id" title="var">z</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_diff_lt</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>,  <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → ¬ <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_notle_lt</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">A</span>,  <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → ¬ <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">Olt_neq</span> @<span class="id" title="var">Olt_neq_rev</span> @<span class="id" title="var">Olt_le</span> @<span class="id" title="var">Olt_notle</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Ole_diff_lt</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_antirefl</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span>, ¬ <span class="id" title="var">x</span> &lt; <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_lt_trans</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<span class="id" title="var">A</span>, <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">y</span> &lt; <span class="id" title="var">z</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Olt_le_trans</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">z</span>:<span class="id" title="var">A</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">z</span> → <span class="id" title="var">x</span> &lt; <span class="id" title="var">z</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Olt_antirefl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Ole_not_lt</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">A</span>, <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → ¬ <span class="id" title="var">y</span> &lt; <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Ole_not_lt</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} : (<span class="id" title="var">Olt</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> --&gt; <span class="id" title="var">Ole</span> &#8702;  <span class="id" title="var">Basics.impl</span> <span class="id" title="keyword">as</span> <span class="id" title="var">Olt_le_compat</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab128"></a><h3 class="section">Dual order</h3>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">Iord</span></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene_inv.html#SetContainingBothLeft.Case.y"><span class="id" title="variable">y</span></a></span> <span class="inlinecode">=</span>  <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene_inv.html#SetContainingBothLeft.Case.y"><span class="id" title="variable">y</span></a></span> <span class="inlinecode"> &le; </span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a></span> <span class="inlinecode"></span>  
</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Iord</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">O</span> {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>}, <span class="id" title="var">ord</span> <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">Iord</span> [[<span class="id" title="var">o</span>]].<br/>

<br/>
</div>

<div class="doc">
<a name="lab129"></a><h3 class="section">Order on functions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fun_ext</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> (<span class="id" title="var">R</span>:<span class="id" title="var">relation</span> <span class="id" title="var">B</span>) : <span class="id" title="var">relation</span> (<span class="id" title="var">A</span> → <span class="id" title="var">B</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> ⇒ <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">R</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>) (<span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">fun_ext</span> [<span class="id" title="var">B</span>].<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="var">ford</span></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene.html#g"><span class="id" title="variable">g</span></a></span> <span class="inlinecode"></span> := <span class="inlinecode"></span> <span class="inlinecode"><span class="id" title="keyword">∀</span></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a>,</span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a></span> <span class="inlinecode"> &le; </span> <span class="inlinecode"><a class="idref" href="Combi.LRrule.Greene.html#g"><span class="id" title="variable">g</span></a></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.ordtype.html#Inhabited.x"><span class="id" title="projection">x</span></a></span> <span class="inlinecode"></span> 
</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Instance</span> <span class="id" title="var">ford</span> <span class="id" title="var">A</span> <span class="id" title="var">O</span> {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} : <span class="id" title="var">ord</span> (<span class="id" title="var">A</span> → <span class="id" title="var">O</span>) := <br/>
&nbsp;&nbsp;{<span class="id" title="var">Oeq</span>:=<span class="id" title="var">fun_ext</span> <span class="id" title="var">A</span> (<span class="id" title="var">Oeq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">O</span>));<span class="id" title="var">Ole</span>:=<span class="id" title="var">fun_ext</span> <span class="id" title="var">A</span> (<span class="id" title="var">Ole</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">O</span>))}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ford_le_elim</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span> → <span class="id" title="var">O</span>), <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">ford_le_elim</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ford_le_intro</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span> → <span class="id" title="var">O</span>), ( <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">n</span> ) → <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">ford_le_intro</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ford_eq_elim</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span> → <span class="id" title="var">O</span>), <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">ford_eq_elim</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ford_eq_intro</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">A</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span> → <span class="id" title="var">O</span>), ( <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">n</span> ) → <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">ford_eq_intro</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab130"></a><h2 class="section">Monotonicity</h2>

<div class="paragraph"> </div>

<a name="lab131"></a><h3 class="section">Definition and properties</h3>

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">monotonic</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic_def</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monotonic_intro</span> : <span class="id" title="keyword">∀</span>  `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>) → <span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">monotonic_intro</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} : <span class="id" title="var">f</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">Ole</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">Oa</span>) &#8702; <span class="id" title="var">Ole</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">Ob</span>))<br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">monotonic_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">stable</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stable_def</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Unfold</span> <span class="id" title="var">stable</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">stable_intro</span> : <span class="id" title="keyword">∀</span>  `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>) → <span class="id" title="var">stable</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">stable_intro</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">s</span>:<span class="id" title="var">stable</span> <span class="id" title="var">f</span>} : <span class="id" title="var">f</span><br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (<span class="id" title="var">Oeq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">Oa</span>) &#8702; <span class="id" title="var">Oeq</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">Ob</span>))<br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">stable_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Type</span><span class="id" title="var">classes</span> <span class="id" title="keyword">Opaque</span> <span class="id" title="var">monotonic</span> <span class="id" title="var">stable</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">monotonic_stable</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:  <span class="id" title="var">stable</span>  <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab132"></a><h3 class="section">Type of monotonic functions</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">fmon</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>}:= <span class="id" title="var">mon</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">fmont</span> :&gt; <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fmonotonic</span>: <span class="id" title="var">monotonic</span> <span class="id" title="var">fmont</span>}.<br/>

<br/>

<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">mon</span> [[<span class="id" title="var">Oa</span>] [<span class="id" title="var">o1</span>] [<span class="id" title="var">Ob</span>] [<span class="id" title="var">o2</span>] [<span class="id" title="var">fmonotonic</span>]].<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">fmon</span> [[<span class="id" title="var">o1</span>] [<span class="id" title="var">o2</span>]].<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fmonotonic</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;Oa -m&gt; Ob" := (<span class="id" title="var">fmon</span> <span class="id" title="var">Oa</span> <span class="id" title="var">Ob</span>) <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 30) : <span class="id" title="var">O_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;Oa --m&gt; Ob" := (<span class="id" title="var">fmon</span> <span class="id" title="var">Oa</span> (<span class="id" title="var">o1</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oa</span>) <span class="id" title="var">Ob</span> ) <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 30) : <span class="id" title="var">O_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;Oa --m-&gt; Ob" := (<span class="id" title="var">fmon</span> <span class="id" title="var">Oa</span> (<span class="id" title="var">o1</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oa</span>) <span class="id" title="var">Ob</span> (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Ob</span>)) <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 30) : <span class="id" title="var">O_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;Oa -m-&gt; Ob" := (<span class="id" title="var">fmon</span> <span class="id" title="var">Oa</span> <span class="id" title="var">Ob</span>  (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Ob</span>)) <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 30) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>){<span class="id" title="var">mf</span>: <span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mon</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mon_simpl</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fstable</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) : <span class="id" title="var">stable</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fstable</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmon_le</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fmon_le</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmon_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fmon_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fmono</span> <span class="id" title="var">Oa</span> <span class="id" title="var">Ob</span> {<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} {<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} : <span class="id" title="var">ord</span> (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) <br/>
&nbsp;&nbsp;&nbsp;:= {<span class="id" title="var">Oeq</span> := <span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">Oa</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)=&gt; <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ole</span> := <span class="id" title="keyword">fun</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">Oa</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)=&gt; <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon_le_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} {<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>}, <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">mon</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">mon</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @ <span class="id" title="var">mon_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon_eq_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Oa</span>→ <span class="id" title="var">Ob</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} {<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>}, <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="var">mon</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">mon</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @ <span class="id" title="var">mon_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">fmont</span> (<span class="id" title="var">Oa</span>:=<span class="id" title="var">Oa</span>) (<span class="id" title="var">Ob</span>:=<span class="id" title="var">Ob</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">fmont_eq_morphism</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab133"></a><h3 class="section">Monotonicity and dual order</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Imonotonic</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic</span> (<span class="id" title="var">o1</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oa</span>) (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Ob</span>) <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Extern</span> 2 (@<span class="id" title="var">monotonic</span> <span class="id" title="var">_</span> (<span class="id" title="var">Iord</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> (<span class="id" title="var">Iord</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">apply</span> @<span class="id" title="var">Imonotonic</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">imon</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Oa</span> --<span class="id" title="var">m</span>→ <span class="id" title="var">Ob</span> := <span class="id" title="var">mon</span> (<span class="id" title="var">o1</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oa</span>) (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Ob</span>) <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">imon_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">imon</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">Iord</span></span> <span class="inlinecode">(<a class="idref" href="Combi.LRrule.freeSchur.html#TableauReading.A"><span class="id" title="variable">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.U"><span class="id" title="variable">U</span></a>)</span> corresponds to <span class="inlinecode"><a class="idref" href="Combi.LRrule.freeSchur.html#TableauReading.A"><span class="id" title="variable">A</span></a></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">Iord</span></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.U"><span class="id" title="variable">U</span></a></span> 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Iord_app</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} (<span class="id" title="var">x</span>: <span class="id" title="var">A</span>) : ((<span class="id" title="var">A</span> → <span class="id" title="var">Oa</span>) --<span class="id" title="var">m</span>→ <span class="id" title="var">Oa</span>).<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">Imon</span></span> <span class="inlinecode"><a class="idref" href="Combi.Basic.combclass.html#BijCard.f"><span class="id" title="variable">f</span></a></span> uses f as monotonic function over the dual order. 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Imon</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>}, (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) → (<span class="id" title="var">Oa</span> --<span class="id" title="var">m</span>→ <span class="id" title="var">Ob</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Imon_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Imon</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab134"></a><h3 class="section">Monotonicity and equality</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon_fun_eq_monotonic</span> <br/>
&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mon_fun_subst</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) (<span class="id" title="var">H</span>:<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span>)<br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> := <span class="id" title="var">mon</span> <span class="id" title="var">f</span> (<span class="id" title="var">fmonotonic</span>:= <span class="id" title="var">mon_fun_eq_monotonic</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon_fun_eq</span><br/>
&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span>:<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span>), <span class="id" title="var">g</span>  &asymp;  <span class="id" title="var">mon_fun_subst</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">H</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab135"></a><h3 class="section">Monotonic functions with 2 arguments</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">monotonic2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic2_intro</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">z</span> <span class="id" title="var">t</span>:<span class="id" title="var">Ob</span>), <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">z</span>  &le;  <span class="id" title="var">t</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon2_intro</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">m1</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} {<span class="id" title="var">m2</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)} : <span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span> | 10.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon2_elim1</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">m</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} : <span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon2_elim2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">m</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">mon2_elim1</span> @<span class="id" title="var">mon2_elim2</span>: <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mon_comp</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">A</span> → <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">mf</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)} : <span class="id" title="var">A</span> → <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">mon</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_fun_mon</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">m</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} : <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">mon</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">stable2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">stable2_intro</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">z</span> <span class="id" title="var">t</span>:<span class="id" title="var">Ob</span>), <span class="id" title="var">x</span> &asymp; <span class="id" title="var">y</span> → <span class="id" title="var">z</span>  &asymp;  <span class="id" title="var">t</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">monotonic2_stable2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} : <span class="id" title="var">stable2</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Type</span><span class="id" title="var">classes</span> <span class="id" title="keyword">Opaque</span> <span class="id" title="var">monotonic2</span> <span class="id" title="var">stable2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mon2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} : <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> := <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">mon</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon2_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">mon2</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mon2_simpl</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon2_le_compat</span> :  <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) {<span class="id" title="var">mf</span>: <span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} {<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">g</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">mon2</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">mon2</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fun2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fmon2_mon</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">fun2</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fun2_monotonic</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) {<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} : <span class="id" title="var">monotonic</span> (<span class="id" title="var">fun2</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fun2_monotonic</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fmonotonic2</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic2</span> (<span class="id" title="var">fun2</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fmonotonic2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mfun2</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Oa</span>-<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) := <span class="id" title="var">mon</span> (<span class="id" title="var">fun2</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mfun2_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mfun2</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mfun2_mon</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <span class="id" title="var">x</span> : <span class="id" title="var">monotonic</span> (<span class="id" title="var">mfun2</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon2_fun2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>), <span class="id" title="var">mon2</span> (<span class="id" title="var">fun2</span> <span class="id" title="var">f</span>)  &asymp;  <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fun2_mon2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>) {<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} , <span class="id" title="var">fun2</span> (<span class="id" title="var">mon2</span> <span class="id" title="var">f</span>)  &asymp;  <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mon2_fun2</span> @<span class="id" title="var">fun2_mon2</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fstable2</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">stable2</span> (<span class="id" title="var">fun2</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fstable2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Imon2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) → (<span class="id" title="var">Oa</span> --<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> --<span class="id" title="var">m</span>→ <span class="id" title="var">Oc</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Imon2_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">y</span>: <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Imon2</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Imonotonic2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>){<span class="id" title="var">mf</span> : <span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic2</span> (<span class="id" title="var">o1</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oa</span>) (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Ob</span>) (<span class="id" title="var">o3</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oc</span>) <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Extern</span> 2 (@<span class="id" title="var">monotonic2</span> <span class="id" title="var">_</span> (<span class="id" title="var">Iord</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> (<span class="id" title="var">Iord</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> (<span class="id" title="var">Iord</span> <span class="id" title="var">_</span>)  <span class="id" title="var">_</span>) ⇒ <span class="id" title="tactic">apply</span> @<span class="id" title="var">Imonotonic2</span><br/>
&nbsp;&nbsp;: <span class="id" title="var">typeclass_instances</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">imon2</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>){<span class="id" title="var">mf</span> : <span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} : <span class="id" title="var">Oa</span> --<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> --<span class="id" title="var">m</span>→ <span class="id" title="var">Oc</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mon2</span> (<span class="id" title="var">o1</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oa</span>) (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Ob</span>) (<span class="id" title="var">o3</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">Oc</span>) <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">imon2_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>){<span class="id" title="var">mf</span> : <span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">y</span>:<span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">imon2</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab136"></a><h3 class="section">Strict monotonicity</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inj_strict_mon</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) {<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span>) → <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> &lt; <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span> &lt; <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab137"></a><h2 class="section">Sequences</h2>
<a name="lab138"></a><h3 class="section">Usual order on natural numbers</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">natO</span> : <span class="id" title="var">ord</span> <span class="id" title="var">nat</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">Oeq</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ⇒ <span class="id" title="var">n</span> = <span class="id" title="var">m</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Ole</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span> : <span class="id" title="var">nat</span> ⇒ (<span class="id" title="var">n</span>  &le;  <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_Ole</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>, ((<span class="id" title="var">n</span>  &le;  <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span>)-&gt; <span class="id" title="var">n</span>  &le;  <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">le_Ole</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_monotonic</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">nat_monotonic</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nat_monotonic_inv</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)  &le;  <span class="id" title="var">f</span> <span class="id" title="var">n</span>) → <span class="id" title="var">monotonic</span> (<span class="id" title="var">o2</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">O</span>) <span class="id" title="var">f</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">nat_monotonic_inv</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fnatO_intro</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fnatO_elim</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fnatO_elim</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> (mseq_lift_left f n) k = f (n+k) 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_lift_left</span> {<span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) <span class="id" title="var">n</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">n</span>+<span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_seq_lift_left</span> <br/>
&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>}, <span class="id" title="var">monotonic</span> (<span class="id" title="var">seq_lift_left</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mseq_lift_left</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mseq_lift_left_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span> <span class="id" title="var">k</span>:<span class="id" title="var">nat</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mseq_lift_left</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>  <span class="id" title="var">k</span> = <span class="id" title="var">f</span> (<span class="id" title="var">n</span>+<span class="id" title="var">k</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mseq_lift_left_le_compat</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">mseq_lift_left</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">mseq_lift_left</span> <span class="id" title="var">g</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mseq_lift_left_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} : (@<span class="id" title="var">mseq_lift_left</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span>) <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span>  &#8702; <span class="id" title="var">eq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">mseq_lift_left_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mseq_lift_left_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>}: (@<span class="id" title="var">seq_lift_left</span> <span class="id" title="var">O</span>) <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span>  &#8702; <span class="id" title="var">eq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">seq_lift_left_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">seq_lift_left_eq_compat</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> (mseq_lift_right f n) k = f (k+n) 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq_lift_right</span> {<span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) <span class="id" title="var">n</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">k</span>+<span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_seq_lift_right</span> <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> <span class="id" title="var">n</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>}, <span class="id" title="var">monotonic</span> (<span class="id" title="var">seq_lift_right</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mseq_lift_right</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mseq_lift_right_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span> <span class="id" title="var">k</span>:<span class="id" title="var">nat</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mseq_lift_right</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>  <span class="id" title="var">k</span> = <span class="id" title="var">f</span> (<span class="id" title="var">k</span>+<span class="id" title="var">n</span>)%<span class="id" title="var">nat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mseq_lift_right_le_compat</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">mseq_lift_right</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">mseq_lift_right</span> <span class="id" title="var">g</span> <span class="id" title="var">n</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mseq_lift_right_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} : (<span class="id" title="var">mseq_lift_right</span> (<span class="id" title="var">o</span>:=<span class="id" title="var">o</span>)) <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">eq</span> &#8702; <span class="id" title="var">Oeq</span> <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">mseq_lift_right_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>}: (@<span class="id" title="var">seq_lift_right</span> <span class="id" title="var">O</span>) <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span>  &#8702; <span class="id" title="var">eq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">seq_lift_right_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">seq_lift_right_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mseq_lift_right_left</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span>) <span class="id" title="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mseq_lift_left</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>   &asymp;  <span class="id" title="var">mseq_lift_right</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab139"></a><h3 class="section">Monotonicity and functions</h3>

<div class="paragraph"> </div>

<ul class="doclist">
<li>  (shift f x) n = f n x 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">shift_mon_fun</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">Ob</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>) ⇒ <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">shift</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">Ob</span>)) : <span class="id" title="var">A</span> → <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> <br/>
&nbsp;&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ (<span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;&lt;o&gt;" := <span class="id" title="var">shift</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 30, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">shift_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">Ob</span>)) <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> &lt;<span class="id" title="var">o</span>&gt; <span class="id" title="var">x</span>) <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">shift_le_compat</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">Ob</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">shift</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">shift</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">shift_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">shift</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">Oa</span>:=<span class="id" title="var">Oa</span>) (<span class="id" title="var">Ob</span>:=<span class="id" title="var">Ob</span>)) <span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">eq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">shift_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">ishift_mon</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> → (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ishift</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> → (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)) : <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">Ob</span>)<br/>
&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">A</span>) ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) (<span class="id" title="var">fmonotonic</span>:=<span class="id" title="var">ishift_mon</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ishift_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> → (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)) <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ishift</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">ishift_le_compat</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">A</span> → (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">ishift</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">ishift</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">ishift_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">ishift</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) (<span class="id" title="var">Oa</span>:=<span class="id" title="var">Oa</span>) (<span class="id" title="var">Ob</span>:=<span class="id" title="var">Ob</span>)) <span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">eq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">ishift_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">shift_fun_mon</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">m</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)} : <span class="id" title="var">monotonic</span> (<span class="id" title="var">shift</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">shift_mon2</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">shift_mon_fun</span> @<span class="id" title="var">shift_fun_mon</span> @<span class="id" title="var">shift_mon2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mshift</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> := <span class="id" title="var">mon2</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> id c = c 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">id</span> <span class="id" title="var">O</span> {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} : <span class="id" title="var">O</span> → <span class="id" title="var">O</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_id</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>:<span class="id" title="keyword">Type</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>}, <span class="id" title="var">monotonic</span> (<span class="id" title="var">id</span> <span class="id" title="var">O</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> (cte c) n = c 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cte</span> <span class="id" title="var">A</span>  `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} (<span class="id" title="var">c</span>:<span class="id" title="var">Oa</span>) : <span class="id" title="var">A</span> → <span class="id" title="var">Oa</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">c</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_cte</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">c</span>:<span class="id" title="var">Ob</span>), <span class="id" title="var">monotonic</span> (<span class="id" title="var">cte</span> <span class="id" title="var">Oa</span> <span class="id" title="var">c</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mseq_cte</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">c</span>:<span class="id" title="var">O</span>) : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">O</span> := <span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">nat</span> <span class="id" title="var">c</span>).<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} : (@<span class="id" title="var">cte</span> <span class="id" title="var">Oa</span>  <span class="id" title="var">Ob</span> <span class="id" title="var">_</span>) <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span>  &#8702;  <span class="id" title="var">Ole</span> <span class="id" title="keyword">as</span> <span class="id" title="var">cte_le_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} : (@<span class="id" title="var">cte</span> <span class="id" title="var">Oa</span>  <span class="id" title="var">Ob</span> <span class="id" title="var">_</span>) <br/>
&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span>  &#8702;  <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">cte_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_diag</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mon_diag</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">diag</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)) : <span class="id" title="var">Oa</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmon_diag_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)) (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">diag</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">diag_le_compat</span> :  <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">diag</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">diag</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">diag_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} : (<span class="id" title="var">diag</span> (<span class="id" title="var">Oa</span>:=<span class="id" title="var">Oa</span>) (<span class="id" title="var">Ob</span>:=<span class="id" title="var">Ob</span>)) <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">diag_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">diag_shift</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">diag</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">diag</span> (<span class="id" title="var">mshift</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">diag_shift</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mshift_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt;  <span class="id" title="var">Oc</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">Ob</span>) (<span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>), <span class="id" title="var">mshift</span> <span class="id" title="var">h</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mshift_le_compat</span> :  <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt;  <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt;  <span class="id" title="var">Oc</span>), <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">mshift</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">mshift</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mshift_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} : (@<span class="id" title="var">mshift</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span>  &#8702; <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">mshift_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mshift2_eq</span> :  <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt;  <span class="id" title="var">Oc</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mshift</span> (<span class="id" title="var">mshift</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="var">h</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> (f@g) x = f (g x) 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">monotonic_comp</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span>){<span class="id" title="var">mf</span> : <span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>){<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>} : <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">monotonic_comp</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">monotonic_comp_mon</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) : <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">monotonic_comp_mon</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">comp</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> := <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;@" := <span class="id" title="var">comp</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 35) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>), (<span class="id" title="var">f@g</span>) <span class="id" title="var">x</span> = <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>}: (@<span class="id" title="var">comp</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> ++&gt; <span class="id" title="var">Ole</span>  ++&gt; <span class="id" title="var">Ole</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">comp_le_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">comp_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} : (@<span class="id" title="var">comp</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">comp_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">comp_eq_compat</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> (f@2 g) h x = f (g x) (h x) 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_app2</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> → <span class="id" title="var">Oc</span> → <span class="id" title="var">Od</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Ob</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">Oa</span> → <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>}{<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>} {<span class="id" title="var">mh</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">h</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) (<span class="id" title="var">h</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_app2_mon</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) (<span class="id" title="var">h</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">app2</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) : <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) (<span class="id" title="var">h</span> <span class="id" title="var">x</span>)).<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;@2" := <span class="id" title="var">app2</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>}: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">app2</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span> <span class="id" title="var">Od</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> ++&gt; <span class="id" title="var">Ole</span>  ++&gt; <span class="id" title="var">Ole</span> ++&gt; <span class="id" title="var">Ole</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">app2_le_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">app2_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>}: <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(@<span class="id" title="var">app2</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span> <span class="id" title="var">Od</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span>  &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">app2_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">app2_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">app2_simpl</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f@2</span> <span class="id" title="var">g</span>) <span class="id" title="var">h</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>) (<span class="id" title="var">h</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_monotonic_right</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">g1</span> <span class="id" title="var">g2</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g1</span> &le;  <span class="id" title="var">g2</span> → <span class="id" title="var">f</span> @ <span class="id" title="var">g1</span>  &le;  <span class="id" title="var">f</span> @ <span class="id" title="var">g2</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">comp_monotonic_right</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">comp_monotonic_left</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} (<span class="id" title="var">f1</span> <span class="id" title="var">f2</span>: <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f1</span> &le;  <span class="id" title="var">f2</span> → <span class="id" title="var">f1</span> @ <span class="id" title="var">g</span>  &le;  <span class="id" title="var">f2</span> @ <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">comp_monotonic_left</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">comp_monotonic2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic2</span> (@<span class="id" title="var">comp</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">comp_monotonic2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcomp</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} :<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) := <span class="id" title="var">mon2</span> (@<span class="id" title="var">comp</span> <span class="id" title="var">Oa</span> <span class="id" title="var">_</span> <span class="id" title="var">Ob</span> <span class="id" title="var">_</span> <span class="id" title="var">Oc</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">fcomp</span> [[<span class="id" title="var">o1</span>] [<span class="id" title="var">o2</span>] [<span class="id" title="var">o3</span>]].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcomp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>), <span class="id" title="var">fcomp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> = <span class="id" title="var">f@g</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcomp2</span>  `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Oc</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>):=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fcomp</span> <span class="id" title="var">Oa</span> (<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>))@(<span class="id" title="var">fcomp</span> <span class="id" title="var">Ob</span> <span class="id" title="var">Oc</span> <span class="id" title="var">Od</span>).<br/>

<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">fcomp2</span> [[<span class="id" title="var">o1</span>] [<span class="id" title="var">o2</span>] [<span class="id" title="var">o3</span>] [<span class="id" title="var">o4</span>]].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcomp2_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Od</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oc</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>)(<span class="id" title="var">y</span>:<span class="id" title="var">Ob</span>), <span class="id" title="var">fcomp2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmon_le_compat2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>: <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">Oa</span>) (<span class="id" title="var">z</span> <span class="id" title="var">t</span>:<span class="id" title="var">Ob</span>), <span class="id" title="var">x</span> &le; <span class="id" title="var">y</span> → <span class="id" title="var">z</span>  &le; <span class="id" title="var">t</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">fmon_le_compat2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmon_cte_comp</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">c</span>:<span class="id" title="var">Oc</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Ob</span>), (<span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">Ob</span> <span class="id" title="var">c</span>)) @ <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">Oa</span> <span class="id" title="var">c</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab140"></a><h2 class="section">Abstract relational notion of lubs</h2>

</div>
<div class="code">
<span class="id" title="keyword">Record</span> <span class="id" title="var">islub</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) : <span class="id" title="keyword">Prop</span> := <span class="id" title="var">mk_islub</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">le_islub</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>,  <span class="id" title="var">f</span> <span class="id" title="var">i</span>  &le;  <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">islub_le</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">y</span>, (<span class="id" title="keyword">∀</span>  <span class="id" title="var">i</span>,  <span class="id" title="var">f</span> <span class="id" title="var">i</span>  &le;  <span class="id" title="var">y</span>) → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span>}.<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">islub</span> [<span class="id" title="var">O</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span>].<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">le_islub</span> [<span class="id" title="var">O</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>].<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">islub_le</span> [<span class="id" title="var">O</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>].<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">isglb</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) : <span class="id" title="keyword">Prop</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">islub</span> (<span class="id" title="var">o</span>:=<span class="id" title="var">Iord</span> <span class="id" title="var">O</span>) <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">isglb</span> [<span class="id" title="var">O</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_isglb</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>,  <span class="id" title="var">x</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">i</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isglb_le</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">y</span>, (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>,  <span class="id" title="var">y</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">i</span>) → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">le_isglb</span> [<span class="id" title="var">O</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>].<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">isglb_le</span> [<span class="id" title="var">O</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>].<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mk_isglb</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>,  <span class="id" title="var">x</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">i</span>) → (<span class="id" title="keyword">∀</span> <span class="id" title="var">y</span>, (<span class="id" title="keyword">∀</span> <span class="id" title="var">i</span>,  <span class="id" title="var">y</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">i</span>) → <span class="id" title="var">y</span>  &le;  <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_eq_compat</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> &asymp; <span class="id" title="var">g</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">g</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_eq_compat_left</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> &asymp; <span class="id" title="var">g</span> → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_eq_compat_right</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isglb_eq_compat</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> &asymp; <span class="id" title="var">g</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">g</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isglb_eq_compat_left</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> &asymp; <span class="id" title="var">g</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isglb_eq_compat_right</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) <span class="id" title="var">I</span> (<span class="id" title="var">f</span>:<span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">O</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} <span class="id" title="var">I</span> : (@<span class="id" title="var">islub</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span>) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">iff</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">islub_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} <span class="id" title="var">I</span> : (@<span class="id" title="var">isglb</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span>) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">iff</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">isglb_morphism</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} <span class="id" title="var">I</span> : (@<span class="id" title="var">islub</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span>) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">I</span> <span class="id" title="var">O</span> (@<span class="id" title="var">Oeq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">iff</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">islub_morphism_ext</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} <span class="id" title="var">I</span> : (@<span class="id" title="var">isglb</span> <span class="id" title="var">_</span> <span class="id" title="var">o</span> <span class="id" title="var">I</span>) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> (@<span class="id" title="var">pointwise_relation</span> <span class="id" title="var">I</span> <span class="id" title="var">O</span> (@<span class="id" title="var">Oeq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)) &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">iff</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">isglb_morphism_ext</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_incr_ext</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span> :<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">f</span> <span class="id" title="var">k</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>)) → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">n</span> + <span class="id" title="var">k</span>)) <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_incr_lift</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span> :<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">f</span> <span class="id" title="var">k</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>)) → <span class="id" title="var">islub</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">n</span> + <span class="id" title="var">k</span>)) <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isglb_decr_ext</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span> :<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>)  &le;  <span class="id" title="var">f</span> <span class="id" title="var">k</span>) → <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">isglb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">n</span> + <span class="id" title="var">k</span>)) <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">isglb_decr_lift</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">f</span> :<span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>)  &le;  <span class="id" title="var">f</span> <span class="id" title="var">k</span>) → <span class="id" title="var">isglb</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">n</span> + <span class="id" title="var">k</span>)) <span class="id" title="var">x</span> → <span class="id" title="var">isglb</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">islub_incr_ext</span> <span class="id" title="var">isglb_decr_ext</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_exch</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} (<span class="id" title="var">F</span> :<span class="id" title="var">nat</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">nat</span> → <span class="id" title="var">O</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">m</span>, <span class="id" title="var">islub</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> ⇒ <span class="id" title="var">F</span> <span class="id" title="var">n</span> <span class="id" title="var">m</span>) (<span class="id" title="var">f</span> <span class="id" title="var">m</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">islub</span> (<span class="id" title="var">F</span> <span class="id" title="var">n</span>) (<span class="id" title="var">g</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_decr</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} {<span class="id" title="var">I</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">O</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span>) → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">g</span> <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_unique_eq</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} {<span class="id" title="var">I</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">O</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span>) → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">g</span> <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_unique</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} {<span class="id" title="var">I</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">I</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">O</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">islub</span> <span class="id" title="var">f</span> <span class="id" title="var">y</span> → <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_fun_intro</span> <span class="id" title="var">O</span> (<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>) {<span class="id" title="var">I</span> <span class="id" title="var">A</span>} (<span class="id" title="var">F</span> : <span class="id" title="var">I</span> → <span class="id" title="var">A</span> → <span class="id" title="var">O</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> → <span class="id" title="var">O</span>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">islub</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> ⇒ <span class="id" title="var">F</span> <span class="id" title="var">i</span> <span class="id" title="var">x</span>) (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) → <span class="id" title="var">islub</span> <span class="id" title="var">F</span> <span class="id" title="var">f</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab141"></a><h2 class="section">Basic operators of omega-cpos</h2>

<div class="paragraph"> </div>

<ul class="doclist">
<li> Constant : <span class="inlinecode">0</span> 
<ul class="doclist">
<li> lub : limit of monotonic sequences

</li>
</ul>

</li>
</ul>

</div>
<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab142"></a><h3 class="section">Definition of cpos</h3>

</div>
<div class="code">
<span class="id" title="keyword">Class</span> <span class="id" title="var">cpo</span>  `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D</span>} : <span class="id" title="keyword">Type</span> := <span class="id" title="var">mk_cpo</span> <br/>
&nbsp;&nbsp;{<span class="id" title="var">D0</span> : <span class="id" title="var">D</span>; <span class="id" title="var">lub</span>: <span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">D</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Dbot</span> : <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>:<span class="id" title="var">D</span>, <span class="id" title="var">D0</span>  &le;  <span class="id" title="var">x</span>; <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">le_lub</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">lub</span> <span class="id" title="var">f</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub_le</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">D</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">x</span>) → <span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">x</span>}.<br/>

<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">cpo</span> [[<span class="id" title="var">o</span>]].<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;0" := <span class="id" title="var">D0</span> : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Dbot</span> @<span class="id" title="var">le_lub</span> @<span class="id" title="var">lub_le</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mon_ord_equiv</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D2</span>} {<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D2</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">eq_ord</span> <span class="id" title="var">o1</span> <span class="id" title="var">o2</span> → <span class="id" title="var">fmon</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> (<span class="id" title="var">o2</span>:=<span class="id" title="var">o2</span>) → <span class="id" title="var">fmon</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> (<span class="id" title="var">o2</span>:=<span class="id" title="var">o1</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mon_ord_equiv_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D2</span>} {<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">H</span>:<span class="id" title="var">eq_ord</span> <span class="id" title="var">o1</span> <span class="id" title="var">o2</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">fmon</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> (<span class="id" title="var">o2</span>:=<span class="id" title="var">o2</span>)) (<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mon_ord_equiv</span> <span class="id" title="var">H</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cpo_ord_equiv</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D</span>} (<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">eq_ord</span> <span class="id" title="var">o1</span> <span class="id" title="var">o2</span> → <span class="id" title="var">cpo</span> (<span class="id" title="var">o</span>:=<span class="id" title="var">o1</span>) <span class="id" title="var">D</span> → <span class="id" title="var">cpo</span> (<span class="id" title="var">o</span>:=<span class="id" title="var">o2</span>) <span class="id" title="var">D</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab143"></a><h3 class="section">Least upper bounds</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">lub</span> (<span class="id" title="var">cpo</span>:=<span class="id" title="var">c</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> ++&gt; <span class="id" title="var">Ole</span> <span class="id" title="keyword">as</span> <span class="id" title="var">lub_le_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}: (<span class="id" title="var">lub</span> (<span class="id" title="var">cpo</span>:=<span class="id" title="var">c</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">lub_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;'mlub' f" := (<span class="id" title="var">lub</span> (<span class="id" title="var">mon</span> <span class="id" title="var">f</span>)) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 60) : <span class="id" title="var">O_scope</span> .<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlub_le_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">D</span>) {<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} {<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">mlub</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">mlub</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mlub_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlub_eq_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">D</span>) {<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} {<span class="id" title="var">mg</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="var">mlub</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">mlub</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mlub_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span>   <span class="id" title="var">le_mlub</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">D</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">mlub</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span>   <span class="id" title="var">mlub_le</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">D</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>}(<span class="id" title="var">x</span>:<span class="id" title="var">D</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">x</span>) → <span class="id" title="var">mlub</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">x</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">le_mlub</span> @<span class="id" title="var">mlub_le</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_mlub</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">D</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">islub</span> <span class="id" title="var">f</span> (<span class="id" title="var">mlub</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">islub_lub</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">islub</span> <span class="id" title="var">f</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">islub_mlub</span> @<span class="id" title="var">islub_lub</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">lub_mon</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : <span class="id" title="var">monotonic</span> <span class="id" title="var">lub</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Lub</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span> := <span class="id" title="var">mon</span> <span class="id" title="var">lub</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">monotonic_lub_comp</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">O</span> → <span class="id" title="var">nat</span> → <span class="id" title="var">D</span>){<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic2</span> <span class="id" title="var">f</span>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">mlub</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_cte</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">d</span>:<span class="id" title="var">D</span>), <span class="id" title="var">mlub</span> (<span class="id" title="var">cte</span> <span class="id" title="var">nat</span> <span class="id" title="var">d</span>)  &asymp;  <span class="id" title="var">d</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_cte</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlub_lift_right</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">mlub</span> (<span class="id" title="var">seq_lift_right</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mlub_lift_right</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mlub_lift_left</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">mlub</span> (<span class="id" title="var">seq_lift_left</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mlub_lift_left</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_lift_right</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">mseq_lift_right</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_lift_right</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_lift_left</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">n</span>, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">mseq_lift_left</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_lift_left</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_le_lift</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">n</span>  &le;  <span class="id" title="var">k</span> → <span class="id" title="var">f</span> <span class="id" title="var">k</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">k</span>) → <span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">lub</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_eq_lift</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) {<span class="id" title="var">m</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>} {<span class="id" title="var">m'</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">g</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">n</span>  &le;  <span class="id" title="var">k</span> → <span class="id" title="var">f</span> <span class="id" title="var">k</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">k</span>) → <span class="id" title="var">lub</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">lub</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_seq_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> → <span class="id" title="var">D</span>) (<span class="id" title="var">g</span>: <span class="id" title="var">nat</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">H</span>:<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">g</span>  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">mon_fun_subst</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> <span class="id" title="var">H</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_Olt</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">k</span>:<span class="id" title="var">D</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">k</span> &lt; <span class="id" title="var">lub</span> <span class="id" title="var">f</span> → ¬ (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">k</span>).<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> (lub_fun h) x = lub_n (h n x) 
</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">lub_fun</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">D</span>)) : <span class="id" title="var">A</span> → <span class="id" title="var">D</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">mlub</span> (<span class="id" title="var">h</span> &lt;<span class="id" title="var">o</span>&gt; <span class="id" title="var">x</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">lub_shift_mon</span>  {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) ⇒ <span class="id" title="var">lub</span> (<span class="id" title="var">mshift</span> <span class="id" title="var">h</span> <span class="id" title="var">x</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_shift_mon</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab144"></a><h3 class="section">Functional cpos</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcpo</span> {<span class="id" title="var">A</span>: <span class="id" title="keyword">Type</span>} `(<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>) : <span class="id" title="var">cpo</span> (<span class="id" title="var">A</span> → <span class="id" title="var">D</span>) :=<br/>
&nbsp;&nbsp;&nbsp;{<span class="id" title="var">D0</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span>:<span class="id" title="var">A</span> ⇒ (0:<span class="id" title="var">D</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> :=  <span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> ⇒ <span class="id" title="var">lub_fun</span> <span class="id" title="var">f</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcpo_lub_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">D</span>))(<span class="id" title="var">x</span>:<span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">lub</span> <span class="id" title="var">h</span>) <span class="id" title="var">x</span> = <span class="id" title="var">lub</span> (<span class="id" title="var">h</span> &lt;<span class="id" title="var">o</span>&gt; <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_ishift</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span>:<span class="id" title="var">A</span> → (<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> (<span class="id" title="var">ishift</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">lub</span> (<span class="id" title="var">h</span> <span class="id" title="var">x</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab145"></a><h2 class="section">Cpo of monotonic functions</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fmon_cpo</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : <span class="id" title="var">cpo</span> (<span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">D0</span>  := <span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">O</span> (0:<span class="id" title="var">D</span>));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) ⇒ <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">x</span>:<span class="id" title="var">O</span>) ⇒ <span class="id" title="var">lub</span> (<span class="id" title="var">cpo</span>:=<span class="id" title="var">c</span>) (<span class="id" title="var">mshift</span> <span class="id" title="var">h</span> <span class="id" title="var">x</span>))}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fmon_lub_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>))(<span class="id" title="var">x</span>:<span class="id" title="var">O</span>), (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>) <span class="id" title="var">x</span> = <span class="id" title="var">lub</span> (<span class="id" title="var">mshift</span> <span class="id" title="var">h</span> <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fmon_lub_simpl</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mon_fun_lub</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">O</span> → <span class="id" title="var">D</span>)) {<span class="id" title="var">mh</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">h</span> <span class="id" title="var">n</span>)}, <span class="id" title="var">monotonic</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
Link between lubs on ordinary functions and monotonic functions 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_mon_fcpo</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">h</span>  &asymp;  <span class="id" title="var">mon</span> (<span class="id" title="var">lub</span> (<span class="id" title="var">mfun2</span> <span class="id" title="var">h</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_fcpo_mon</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">O</span> → <span class="id" title="var">D</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">mh</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">h</span> <span class="id" title="var">x</span>)}, <span class="id" title="var">lub</span> <span class="id" title="var">h</span>  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">mon2</span> <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">double_lub_diag</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt;  <span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">diag</span> <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">double_lub_diag</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">double_lub_shift</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt;  <span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">lub</span> (<span class="id" title="var">mshift</span> <span class="id" title="var">h</span>)).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">double_lub_shift</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab146"></a><h2 class="section">Continuity</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_comp_le</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> (<span class="id" title="var">f</span> @ <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_comp_le</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_app2_le</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">g</span>: <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> ((<span class="id" title="var">F</span> @&sup2; <span class="id" title="var">f</span>) <span class="id" title="var">g</span>)  &le;  <span class="id" title="var">F</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) (<span class="id" title="var">lub</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_app2_le</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">continuous</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) :=  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cont_intro</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>), <span class="id" title="var">f</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">f</span> @ <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Type</span><span class="id" title="var">classes</span> <span class="id" title="keyword">Opaque</span> <span class="id" title="var">continuous</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous_eq_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}(<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="var">continuous</span> <span class="id" title="var">f</span> → <span class="id" title="var">continuous</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : (@<span class="id" title="var">continuous</span> <span class="id" title="var">D1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">D2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">iff</span> <br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">continuous_eq_compat_iff</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_comp_eq</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>),  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> <span class="id" title="var">f</span> → <span class="id" title="var">f</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">f</span> @ <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">lub_comp_eq</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> mon0 x == 0 
</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Instance</span> <span class="id" title="var">cont0</span>  `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : <span class="id" title="var">continuous</span> (<span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">D1</span> (0:<span class="id" title="var">D2</span>))).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">cont0</span> [].<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> double_app f g n m = f m (g n) 
</li>
</ul>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">double_app</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Ob</span>} `{<span class="id" title="var">o3</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oc</span>} `{<span class="id" title="var">o4</span>: <span class="id" title="var">ord</span> <span class="id" title="var">Od</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oc</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Ob</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Od</span>) := <span class="id" title="var">mon</span> ((<span class="id" title="var">mshift</span> <span class="id" title="var">f</span>) @ <span class="id" title="var">g</span>).<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab147"></a><h3 class="section">Continuity</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">continuous2</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}  (<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)  := <br/>
<span class="id" title="var">continuous2_intro</span> : <span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">g</span> :<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">F</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) (<span class="id" title="var">lub</span> <span class="id" title="var">g</span>)  &le;  <span class="id" title="var">lub</span> ((<span class="id" title="var">F</span> @&sup2; <span class="id" title="var">f</span>) <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_app</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) {<span class="id" title="var">cF</span>:<span class="id" title="var">continuous2</span> <span class="id" title="var">F</span>} (<span class="id" title="var">k</span>:<span class="id" title="var">D1</span>), <span class="id" title="var">continuous</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>).<br/>

<br/>
<span class="id" title="keyword">Type</span><span class="id" title="var">classes</span> <span class="id" title="keyword">Opaque</span> <span class="id" title="var">continuous2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_eq_compat</span> : <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="var">continuous2</span> <span class="id" title="var">f</span> → <span class="id" title="var">continuous2</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_continuous</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>), <span class="id" title="var">continuous2</span> <span class="id" title="var">F</span> → <span class="id" title="var">continuous</span> <span class="id" title="var">F</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">continuous2_continuous</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_left</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> <span class="id" title="var">F</span> →  <span class="id" title="var">F</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>) <span class="id" title="var">x</span>  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">mshift</span> (<span class="id" title="var">F</span> @ <span class="id" title="var">h</span>) <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_right</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>)(<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous2</span> <span class="id" title="var">F</span> →  <span class="id" title="var">F</span> <span class="id" title="var">x</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span> @ <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous_continuous2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">cFr</span>: <span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>:<span class="id" title="var">D1</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>)) (<span class="id" title="var">cF</span>: <span class="id" title="var">continuous</span> <span class="id" title="var">F</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous2</span> <span class="id" title="var">F</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">continuous2_app</span> @<span class="id" title="var">continuous2_continuous</span> @<span class="id" title="var">continuous_continuous2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_app2_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) {<span class="id" title="var">cFr</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>:<span class="id" title="var">D1</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>)} {<span class="id" title="var">cF</span> : <span class="id" title="var">continuous</span> <span class="id" title="var">F</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">F</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) (<span class="id" title="var">lub</span> <span class="id" title="var">g</span>)  &asymp;  <span class="id" title="var">lub</span> ((<span class="id" title="var">F@2</span> <span class="id" title="var">f</span>) <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_cont2_app2_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>){<span class="id" title="var">cF</span> : <span class="id" title="var">continuous2</span> <span class="id" title="var">F</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">F</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) (<span class="id" title="var">lub</span> <span class="id" title="var">g</span>)  &asymp;  <span class="id" title="var">lub</span> ((<span class="id" title="var">F@2</span> <span class="id" title="var">f</span>) <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mshift_continuous2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>), <span class="id" title="var">continuous2</span> <span class="id" title="var">F</span> → <span class="id" title="var">continuous2</span> (<span class="id" title="var">mshift</span> <span class="id" title="var">F</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">mshift_continuous2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monotonic_sym</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> → <span class="id" title="var">D1</span> → <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">F</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>) → (<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>:<span class="id" title="var">D1</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>)) → <span class="id" title="var">monotonic</span> <span class="id" title="var">F</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">monotonic_sym</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">monotonic2_sym</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">o2</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> → <span class="id" title="var">D1</span> → <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">F</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>) → (<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>:<span class="id" title="var">D1</span>, <span class="id" title="var">monotonic</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>)) → <span class="id" title="var">monotonic2</span> <span class="id" title="var">F</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> @<span class="id" title="var">monotonic2_sym</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous_sym</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">F</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>) → (<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>:<span class="id" title="var">D1</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>)) → <span class="id" title="var">continuous</span> <span class="id" title="var">F</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_sym</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt;<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt;<span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>  &asymp;  <span class="id" title="var">F</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>) → (<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">F</span> <span class="id" title="var">k</span>)) → <span class="id" title="var">continuous2</span> <span class="id" title="var">F</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">continuous2_sym</span>.<br/>

<br/>
</div>

<div class="doc">

<div class="paragraph"> </div>

<ul class="doclist">
<li> continuity is preserved by composition 
</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous_comp</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} <br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>), <span class="id" title="var">continuous</span> <span class="id" title="var">f</span> → <span class="id" title="var">continuous</span> <span class="id" title="var">g</span> → <span class="id" title="var">continuous</span> (<span class="id" title="var">mon</span> (<span class="id" title="var">f@g</span>)).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">continuous_comp</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_comp</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} `{<span class="id" title="var">c4</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D4</span>}<br/>
&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D4</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">continuous</span> <span class="id" title="var">f</span> → <span class="id" title="var">continuous2</span> <span class="id" title="var">g</span> → <span class="id" title="var">continuous2</span> (<span class="id" title="var">g</span> @ <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">continuous2_comp</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_comp2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} `{<span class="id" title="var">c4</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D4</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D3</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D4</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> <span class="id" title="var">f</span> → <span class="id" title="var">continuous2</span> <span class="id" title="var">g</span> → <span class="id" title="var">continuous2</span> (<span class="id" title="var">fcomp2</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> <span class="id" title="var">D4</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">continuous2_comp2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">continuous2_app2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} `{<span class="id" title="var">c4</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D4</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">F</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">D4</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">D4</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>), <span class="id" title="var">continuous2</span> <span class="id" title="var">F</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> <span class="id" title="var">f</span> → <span class="id" title="var">continuous</span> <span class="id" title="var">g</span> → <span class="id" title="var">continuous</span> ((<span class="id" title="var">F</span> @&sup2; <span class="id" title="var">f</span>) <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">continuous2_app2</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab148"></a><h2 class="section">Cpo of continuous functions</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">lub_continuous</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>)) {<span class="id" title="var">cf</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">f</span> <span class="id" title="var">n</span>)}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">continuous</span>  (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Record</span> <span class="id" title="var">fcont</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}: <span class="id" title="keyword">Type</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">cont</span> {<span class="id" title="var">fcontm</span> :&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>; <span class="id" title="var">fcontinuous</span> : <span class="id" title="var">continuous</span> <span class="id" title="var">fcontm</span>}.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcontinuous</span>.<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">fcont</span> [[<span class="id" title="var">o</span>][<span class="id" title="var">c1</span>] [<span class="id" title="var">o0</span>][<span class="id" title="var">c2</span>]].<br/>
<span class="id" title="keyword">Implicit Arguments</span> <span class="id" title="var">cont</span> [[<span class="id" title="var">D1</span>][<span class="id" title="var">o</span>][<span class="id" title="var">c1</span>] [<span class="id" title="var">D2</span>][<span class="id" title="var">o0</span>][<span class="id" title="var">c2</span>] [<span class="id" title="var">fcontinuous</span>]].<br/>

<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;-c&gt;" := <span class="id" title="var">fcont</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 30, <span class="id" title="tactic">right</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_fun</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) : <span class="id" title="var">D1</span> → <span class="id" title="var">D2</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">f</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcont_ord</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : <span class="id" title="var">ord</span> (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)<br/>
&nbsp;&nbsp;:= {<span class="id" title="var">Oeq</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> ⇒ <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>; <span class="id" title="var">Ole</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> ⇒  <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_le_intro</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>) → <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_le_elim</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_eq_intro</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>) → <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_eq_elim</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">g</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_le</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_le</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont0</span> <span class="id" title="var">D1</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} <span class="id" title="var">D2</span> `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> := <span class="id" title="var">cont</span> (<span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">D1</span> (0:<span class="id" title="var">D2</span>))).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcontm_monotonic</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic</span> (<span class="id" title="var">fcontm</span> (<span class="id" title="var">D1</span>:=<span class="id" title="var">D1</span>) (<span class="id" title="var">D2</span>:=<span class="id" title="var">D2</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} <span class="id" title="var">D2</span> `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">mon</span> (<span class="id" title="var">fcontm</span> (<span class="id" title="var">D1</span>:=<span class="id" title="var">D1</span>) (<span class="id" title="var">D2</span>:=<span class="id" title="var">D2</span>)).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcont_lub_continuous</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> (<span class="id" title="var">lub</span> (<span class="id" title="var">D</span>:=<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> @ <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_lub</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : (<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)) → <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">f</span> ⇒ <span class="id" title="var">cont</span> (<span class="id" title="var">lub</span> (<span class="id" title="var">D</span>:=<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> @ <span class="id" title="var">f</span>)).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcont_cpo</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : <span class="id" title="var">cpo</span> (<span class="id" title="var">D1</span>-<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">D0</span>:=<span class="id" title="var">fcont0</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span>; <span class="id" title="var">lub</span>:=<span class="id" title="var">fcont_lub</span> (<span class="id" title="var">D1</span>:=<span class="id" title="var">D1</span>) (<span class="id" title="var">D2</span>:=<span class="id" title="var">D2</span>)}.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_app</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>) : <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mshift</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> @ <span class="id" title="var">f</span>) <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;&lt;_&gt;" := <span class="id" title="var">fcont_app</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_app_simpl</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>)(<span class="id" title="var">y</span>:<span class="id" title="var">O</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> &lt;<span class="id" title="var">_</span>&gt; <span class="id" title="var">x</span>) <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">ishift_continuous</span> : <br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> {<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">A</span> → (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> (<span class="id" title="var">ishift</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_ishift</span> {<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">A</span> → (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; (<span class="id" title="var">A</span> → <span class="id" title="var">D2</span>) := <span class="id" title="var">cont</span> <span class="id" title="var">_</span> (<span class="id" title="var">fcontinuous</span>:=<span class="id" title="var">ishift_continuous</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">mshift_continuous</span> : <span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">continuous</span> (<span class="id" title="var">mshift</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> @ <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_mshift</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)) <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> := <span class="id" title="var">cont</span> (<span class="id" title="var">mshift</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> @ <span class="id" title="var">f</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_app_continuous</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> {<span class="id" title="var">O</span>} {<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">O</span>} `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> &lt;<span class="id" title="var">_</span>&gt; (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">D</span>:=<span class="id" title="var">O</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) ((<span class="id" title="var">fcont_mshift</span> <span class="id" title="var">f</span>) @ <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_lub_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">lub</span> <span class="id" title="var">h</span> <span class="id" title="var">x</span> = <span class="id" title="var">lub</span> (<span class="id" title="var">h</span> &lt;<span class="id" title="var">_</span>&gt; <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">cont_app_monotonic</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">f</span> <span class="id" title="var">k</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">monotonic</span> (<span class="id" title="var">Ob</span>:=<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="keyword">fun</span> (<span class="id" title="var">k</span>:<span class="id" title="var">D1</span>) ⇒ <span class="id" title="var">cont</span> <span class="id" title="var">_</span> (<span class="id" title="var">fcontinuous</span>:=<span class="id" title="var">p</span> <span class="id" title="var">k</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cont_app</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">f</span> <span class="id" title="var">k</span>)) : <span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">k</span> ⇒ <span class="id" title="var">cont</span> (<span class="id" title="var">f</span> <span class="id" title="var">k</span>) (<span class="id" title="var">fcontinuous</span>:=<span class="id" title="var">p</span> <span class="id" title="var">k</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cont_app_simpl</span> : <br/>
<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)(<span class="id" title="var">p</span>:<span class="id" title="keyword">∀</span> <span class="id" title="var">k</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">f</span> <span class="id" title="var">k</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">k</span>:<span class="id" title="var">D1</span>),  <span class="id" title="var">cont_app</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> <span class="id" title="var">k</span> = <span class="id" title="var">cont</span> (<span class="id" title="var">f</span> <span class="id" title="var">k</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">cont2_continuous</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">p</span>:<span class="id" title="var">continuous2</span> <span class="id" title="var">f</span>) : <span class="id" title="var">continuous</span> (<span class="id" title="var">cont_app</span> <span class="id" title="var">f</span> (<span class="id" title="var">continuous2_app</span> <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cont2</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="var">p</span>:<span class="id" title="var">continuous2</span> <span class="id" title="var">f</span>} : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)<br/>
:= <span class="id" title="var">cont</span> (<span class="id" title="var">cont_app</span> <span class="id" title="var">f</span> (<span class="id" title="var">continuous2_app</span> <span class="id" title="var">f</span>)).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Fcontm_continuous</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} : <span class="id" title="var">continuous</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Fcontm_continuous</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcont_comp_continuous</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <span class="id" title="var">continuous</span> (<span class="id" title="var">f</span> @ <span class="id" title="var">g</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_comp</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span> := <span class="id" title="var">cont</span> (<span class="id" title="var">f</span> @ <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;@_" := <span class="id" title="var">fcont_comp</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 35) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_comp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>), (<span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span>) <span class="id" title="var">x</span> = <span class="id" title="var">f</span> (<span class="id" title="var">g</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcontm_fcont_comp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)(<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <span class="id" title="var">fcontm</span> (<span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span>) = <span class="id" title="var">f</span> @ <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_comp_le_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">k</span> <span class="id" title="var">l</span> :<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">k</span>  &le;  <span class="id" title="var">l</span> → <span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">k</span>  &le;  <span class="id" title="var">g</span> @<span class="id" title="var">_</span> <span class="id" title="var">l</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_comp_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id" title="var">fcont_comp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c3</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> ++&gt; <span class="id" title="var">Ole</span> ++&gt; <span class="id" title="var">Ole</span> <span class="id" title="keyword">as</span> <span class="id" title="var">fcont_comp_le_morph</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;: (@<span class="id" title="var">fcont_comp</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">c3</span>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">fcont_comp_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_Comp</span> <span class="id" title="var">D1</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} <span class="id" title="var">D2</span> `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} <span class="id" title="var">D3</span> `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">mon2</span> <span class="id" title="var">_</span> (<span class="id" title="var">mf</span>:=<span class="id" title="var">fcont_comp_le_compat</span> (<span class="id" title="var">D1</span>:=<span class="id" title="var">D1</span>) (<span class="id" title="var">D2</span>:=<span class="id" title="var">D2</span>) (<span class="id" title="var">D3</span>:=<span class="id" title="var">D3</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_Comp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>), <span class="id" title="var">fcont_Comp</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> = <span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcont_Comp_continuous2</span> <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}, <span class="id" title="var">continuous2</span> (<span class="id" title="var">fcont_Comp</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_COMP</span>  <span class="id" title="var">D1</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} <span class="id" title="var">D2</span> `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} <span class="id" title="var">D3</span> `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) -<span class="id" title="var">c</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="var">cont2</span> (<span class="id" title="var">fcont_Comp</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_COMP_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>: <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fcont_COMP</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> = <span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont2_COMP</span> <span class="id" title="var">D1</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} <span class="id" title="var">D2</span> `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} <span class="id" title="var">D3</span> `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} <span class="id" title="var">D4</span> `{<span class="id" title="var">c4</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D4</span>}<br/>
&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">D3</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D4</span>) -<span class="id" title="var">c</span>&gt; (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D4</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">fcont_COMP</span> <span class="id" title="var">D1</span> (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D4</span>)) @<span class="id" title="var">_</span> (<span class="id" title="var">fcont_COMP</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> <span class="id" title="var">D4</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont2_comp</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} `{<span class="id" title="var">c4</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D4</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D3</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D4</span>)(<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) := <span class="id" title="var">fcont2_COMP</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> <span class="id" title="var">D4</span> <span class="id" title="var">f</span> <span class="id" title="var">F</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;@@_" := <span class="id" title="var">fcont2_comp</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 35) : <span class="id" title="var">O_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont2_comp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} `{<span class="id" title="var">c4</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D4</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D3</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D4</span>)(<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">D1</span>)(<span class="id" title="var">y</span>:<span class="id" title="var">D2</span>), (<span class="id" title="var">f</span> @@<span class="id" title="var">_</span> <span class="id" title="var">F</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_le_compat2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">D1</span>) (<span class="id" title="var">z</span> <span class="id" title="var">t</span> : <span class="id" title="var">D2</span>), <span class="id" title="var">x</span>  &le;  <span class="id" title="var">y</span> → <span class="id" title="var">z</span>  &le;  <span class="id" title="var">t</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_le_compat2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_eq_compat2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">D1</span>) (<span class="id" title="var">z</span> <span class="id" title="var">t</span> : <span class="id" title="var">D2</span>), <span class="id" title="var">x</span>  &asymp;  <span class="id" title="var">y</span> → <span class="id" title="var">z</span>  &asymp;  <span class="id" title="var">t</span> → <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">z</span>  &asymp;  <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_eq_compat2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_continuous</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>)(<span class="id" title="var">h</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">f</span> @ <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_continuous</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fcont_continuous2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>), <span class="id" title="var">continuous2</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> @ <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fcont_continuous2</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">cshift_continuous2</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>), <span class="id" title="var">continuous2</span> (<span class="id" title="var">mshift</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> @ <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">cshift_continuous2</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">cshift</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) <br/>
&nbsp;&nbsp;&nbsp;: <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span> := <span class="id" title="var">cont2</span> (<span class="id" title="var">mshift</span> (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> @ <span class="id" title="var">f</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cshift_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) (<span class="id" title="var">x</span>:<span class="id" title="var">D2</span>) (<span class="id" title="var">y</span>:<span class="id" title="var">D1</span>), <span class="id" title="var">cshift</span> <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fcont_SEQ</span>  <span class="id" title="var">D1</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} <span class="id" title="var">D2</span> `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} <span class="id" title="var">D3</span> `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;: (<span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) -<span class="id" title="var">c</span>&gt; (<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>) -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span> := <span class="id" title="var">cshift</span> (<span class="id" title="var">fcont_COMP</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_SEQ_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>} `{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>} `{<span class="id" title="var">c3</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D3</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>: <span class="id" title="var">D1</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D2</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">D2</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D3</span>), <span class="id" title="var">fcont_SEQ</span> <span class="id" title="var">D1</span> <span class="id" title="var">D2</span> <span class="id" title="var">D3</span> <span class="id" title="var">f</span> <span class="id" title="var">g</span> = <span class="id" title="var">g</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Id_mon</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>}, <span class="id" title="var">monotonic</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span>:<span class="id" title="var">Oa</span> ⇒ <span class="id" title="var">x</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Id</span> <span class="id" title="var">Oa</span> {<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} : <span class="id" title="var">Oa</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">Oa</span> := <span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> ⇒ <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Id_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o1</span>:<span class="id" title="var">ord</span> <span class="id" title="var">Oa</span>} (<span class="id" title="var">x</span>:<span class="id" title="var">Oa</span>), <span class="id" title="var">Id</span> <span class="id" title="var">Oa</span> <span class="id" title="var">x</span> = <span class="id" title="var">x</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab149"></a><h2 class="section">Fixpoints</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iter_</span> {<span class="id" title="var">D</span>} {<span class="id" title="var">o</span>} `{<span class="id" title="var">c</span>: @<span class="id" title="var">cpo</span> <span class="id" title="var">D</span> <span class="id" title="var">o</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">n</span> {<span class="id" title="keyword">struct</span> <span class="id" title="var">n</span>} : <span class="id" title="var">D</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;:= <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> <span class="id" title="var">O</span> ⇒ 0 | <span class="id" title="var">S</span> <span class="id" title="var">m</span> ⇒ <span class="id" title="var">f</span> (<span class="id" title="var">iter_</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter_incr</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">n</span>, <span class="id" title="var">iter_</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">iter_</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">iter_incr</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">iter_mon</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">monotonic</span> (<span class="id" title="var">iter_</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iter</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span> := <span class="id" title="var">mon</span> (<span class="id" title="var">iter_</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fixp</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) : <span class="id" title="var">D</span> := <span class="id" title="var">mlub</span> (<span class="id" title="var">iter_</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_le</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">fixp</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">fixp</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fixp_le</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) {<span class="id" title="var">mf</span>:<span class="id" title="var">continuous</span> <span class="id" title="var">f</span>}, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fixp</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">f</span> (<span class="id" title="var">fixp</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_inv</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>: <span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) <span class="id" title="var">g</span>, <span class="id" title="var">f</span> <span class="id" title="var">g</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">fixp</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fixp_cte</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">d</span>:<span class="id" title="var">D</span>), <span class="id" title="var">fixp</span> (<span class="id" title="var">mon</span> (<span class="id" title="var">cte</span> <span class="id" title="var">D</span> <span class="id" title="var">d</span>))  &asymp;  <span class="id" title="var">d</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fixp_cte</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_le_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">fixp</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">fixp</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fixp_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fixp_monotonic</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : <span class="id" title="var">monotonic</span> <span class="id" title="var">fixp</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">fixp</span> (<span class="id" title="var">c</span>:=<span class="id" title="var">c</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> <span class="id" title="keyword">as</span> <span class="id" title="var">fixp_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fixp_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Fixp</span> <span class="id" title="var">D</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span> := <span class="id" title="var">mon</span> <span class="id" title="var">fixp</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Fixp_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span>-<span class="id" title="var">m</span>&gt;<span class="id" title="var">D</span>), <span class="id" title="var">Fixp</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> = <span class="id" title="var">fixp</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">iter_monotonic</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : <span class="id" title="var">monotonic</span> <span class="id" title="var">iter</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Iter</span> <span class="id" title="var">D</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>) := <span class="id" title="var">mon</span> <span class="id" title="var">iter</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">IterS_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} <span class="id" title="var">f</span> <span class="id" title="var">n</span>, <span class="id" title="var">Iter</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">Iter</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iterO_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>: <span class="id" title="var">D</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">iter</span> <span class="id" title="var">f</span> <span class="id" title="var">O</span> = (0:<span class="id" title="var">D</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iterS_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} <span class="id" title="var">f</span> <span class="id" title="var">n</span>, <span class="id" title="var">iter</span> <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">iter</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter_continuous</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">h</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">iter</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">mon</span> <span class="id" title="var">iter</span> @ <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">iter_continuous</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter_continuous_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">h</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">iter</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">mon</span> <span class="id" title="var">iter</span> @ <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_continuous</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">h</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">fixp</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &le;  <span class="id" title="var">lub</span> (<span class="id" title="var">mon</span> <span class="id" title="var">fixp</span> @ <span class="id" title="var">h</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fixp_continuous</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_continuous_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">h</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; (<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">continuous</span> (<span class="id" title="var">h</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">fixp</span> (<span class="id" title="var">lub</span> <span class="id" title="var">h</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">mon</span> <span class="id" title="var">fixp</span> @ <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Fixp_cont</span> <span class="id" title="var">D</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>) -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span> := <span class="id" title="var">Fixp</span> <span class="id" title="var">D</span> @ (<span class="id" title="var">Fcontm</span> <span class="id" title="var">D</span> <span class="id" title="var">D</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Fixp_cont_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">Fixp_cont</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> = <span class="id" title="var">fixp</span> (<span class="id" title="var">fcontm</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Fixp_cont_continuous</span> :  <span class="id" title="keyword">∀</span> <span class="id" title="var">D</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}, <span class="id" title="var">continuous</span> (<span class="id" title="var">Fixp_cont</span> <span class="id" title="var">D</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} : (<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>) -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span> := <span class="id" title="var">cont</span> (<span class="id" title="var">Fixp_cont</span> <span class="id" title="var">D</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span> = <span class="id" title="var">Fixp</span> <span class="id" title="var">D</span> (<span class="id" title="var">fcontm</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_le_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">FIXP_le_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_eq_compat</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">g</span> → <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">FIXP_eq_compat</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_eq</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>), <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>  &asymp;  <span class="id" title="var">f</span> (<span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">FIXP_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_inv</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">g</span> : <span class="id" title="var">D</span>), <span class="id" title="var">f</span> <span class="id" title="var">g</span>  &le;  <span class="id" title="var">g</span> → <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">g</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab150"></a><h3 class="section">Iteration of functional</h3>

</div>
<div class="code">
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_comp_com</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">D</span>-<span class="id" title="var">c</span>&gt;<span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span>→ <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_comp</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">D</span>-<span class="id" title="var">c</span>&gt;<span class="id" title="var">D</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">g</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span>  &le;  <span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span> → <span class="id" title="var">f</span> (<span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span>)  &le;  <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span> → <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">g</span>)  &asymp;  <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">fcont_compn</span> {<span class="id" title="var">D</span>} {<span class="id" title="var">o</span>} `{<span class="id" title="var">c</span>:@<span class="id" title="var">cpo</span> <span class="id" title="var">D</span> <span class="id" title="var">o</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">n</span>} : <span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span> := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> <span class="id" title="var">O</span> ⇒ <span class="id" title="var">f</span> | <span class="id" title="var">S</span> <span class="id" title="var">p</span> ⇒ <span class="id" title="var">fcont_compn</span> <span class="id" title="var">f</span> <span class="id" title="var">p</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_compn_Sn_simpl</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">D</span> -<span class="id" title="var">c</span>&gt; <span class="id" title="var">D</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">fcont_compn</span> <span class="id" title="var">f</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">fcont_compn</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fcont_compn_com</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">f</span>:<span class="id" title="var">D</span>-<span class="id" title="var">c</span>&gt;<span class="id" title="var">D</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> @<span class="id" title="var">_</span> (<span class="id" title="var">fcont_compn</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>)  &le;  <span class="id" title="var">fcont_compn</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">FIXP_compn</span> : <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span>-<span class="id" title="var">c</span>&gt;<span class="id" title="var">D</span>) (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>), <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> (<span class="id" title="var">fcont_compn</span> <span class="id" title="var">f</span> <span class="id" title="var">n</span>)  &asymp;  <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_double</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">D</span>-<span class="id" title="var">c</span>&gt;<span class="id" title="var">D</span>), <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> (<span class="id" title="var">f</span> @<span class="id" title="var">_</span> <span class="id" title="var">f</span>)  &asymp;  <span class="id" title="var">FIXP</span> <span class="id" title="var">D</span> <span class="id" title="var">f</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
<a name="lab151"></a><h3 class="section">Induction principle</h3>

</div>
<div class="code">
<span class="id" title="keyword">Definition</span> <span class="id" title="var">admissible</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">P</span>:<span class="id" title="var">D</span>→<span class="id" title="keyword">Type</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>, (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">P</span> (<span class="id" title="var">f</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">P</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_ind</span> : <span class="id" title="keyword">∀</span>  `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D</span>}(<span class="id" title="var">F</span>:<span class="id" title="var">D</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D</span>)(<span class="id" title="var">P</span>:<span class="id" title="var">D</span>→<span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admissible</span> <span class="id" title="var">P</span> → <span class="id" title="var">P</span> 0 → (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> → <span class="id" title="var">P</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span>)) → <span class="id" title="var">P</span> (<span class="id" title="var">fixp</span> <span class="id" title="var">F</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">admissible2</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>}`{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}(<span class="id" title="var">R</span>:<span class="id" title="var">D1</span> → <span class="id" title="var">D2</span> → <span class="id" title="keyword">Type</span>) := <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">∀</span> (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>), (<span class="id" title="keyword">∀</span> <span class="id" title="var">n</span>, <span class="id" title="var">R</span> (<span class="id" title="var">f</span> <span class="id" title="var">n</span>) (<span class="id" title="var">g</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">R</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) (<span class="id" title="var">lub</span> <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_ind_rel</span> : <span class="id" title="keyword">∀</span>  `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>}`{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}(<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>) (<span class="id" title="var">G</span>:<span class="id" title="var">D2</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">R</span>:<span class="id" title="var">D1</span> → <span class="id" title="var">D2</span> → <span class="id" title="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">admissible2</span> <span class="id" title="var">R</span> → <span class="id" title="var">R</span> 0 0 → (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">R</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> → <span class="id" title="var">R</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span>) (<span class="id" title="var">G</span> <span class="id" title="var">y</span>)) → <span class="id" title="var">R</span> (<span class="id" title="var">fixp</span> <span class="id" title="var">F</span>) (<span class="id" title="var">fixp</span> <span class="id" title="var">G</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lub_le_fixp</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>}`{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}  (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span>-<span class="id" title="var">m</span>&gt;<span class="id" title="var">D2</span>)  (<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span>:<span class="id" title="var">nat</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">s</span> <span class="id" title="var">O</span>  &le;  <span class="id" title="var">f</span> 0 → (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>, <span class="id" title="var">s</span> <span class="id" title="var">n</span>  &le;  <span class="id" title="var">f</span> <span class="id" title="var">x</span> → <span class="id" title="var">s</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;→ <span class="id" title="var">lub</span> <span class="id" title="var">s</span>  &le;  <span class="id" title="var">f</span> (<span class="id" title="var">fixp</span> <span class="id" title="var">F</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fixp_le_lub</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">c1</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D1</span>}`{<span class="id" title="var">c2</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">D2</span>}  (<span class="id" title="var">f</span>:<span class="id" title="var">D1</span>-<span class="id" title="var">m</span>&gt;<span class="id" title="var">D2</span>)  (<span class="id" title="var">F</span>:<span class="id" title="var">D1</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">D1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">s</span>:<span class="id" title="var">nat</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">D2</span>) {<span class="id" title="var">fc</span>:<span class="id" title="var">continuous</span> <span class="id" title="var">f</span>},<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">f</span> 0  &le;  <span class="id" title="var">s</span> <span class="id" title="var">O</span> → (<span class="id" title="keyword">∀</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span>  &le;  <span class="id" title="var">s</span> <span class="id" title="var">n</span> →  <span class="id" title="var">f</span> (<span class="id" title="var">F</span> <span class="id" title="var">x</span>)  &le;  <span class="id" title="var">s</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>)) → <span class="id" title="var">f</span> (<span class="id" title="var">fixp</span> <span class="id" title="var">F</span>)  &le;  <span class="id" title="var">lub</span> <span class="id" title="var">s</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">continuity</span> <span class="id" title="var">cont</span> <span class="id" title="var">Cont</span> <span class="id" title="var">Hcont</span>:= <br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;| |- (<span class="id" title="var">Ole</span> ?<span class="id" title="var">x1</span> (<span class="id" title="var">lub</span> (<span class="id" title="var">mon</span> (<span class="id" title="keyword">fun</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) ⇒ <span class="id" title="var">cont</span> (@?<span class="id" title="var">g</span> <span class="id" title="var">n</span>))))) ⇒ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">f</span> := <span class="id" title="tactic">fresh</span> "f" <span class="id" title="keyword">in</span> (<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">f</span>:=<span class="id" title="var">g</span>); <span class="id" title="tactic">assert</span> (<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">auto</span> |  (<span class="id" title="tactic">transitivity</span> (<span class="id" title="var">lub</span> (<span class="id" title="var">Cont@</span>(<span class="id" title="var">mon</span> <span class="id" title="var">f</span>))); [<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Hcont</span> | <span class="id" title="tactic">auto</span>])]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">gen_monotonic</span> := <br/>
<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> [(@<span class="id" title="var">mon</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">f</span> ?<span class="id" title="var">mf</span>)] ⇒ <span class="id" title="tactic">generalize</span> (<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">gen_monotonic1</span> <span class="id" title="var">f</span> := <br/>
<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> [(@<span class="id" title="var">mon</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">f</span> ?<span class="id" title="var">mf</span>)] ⇒ <span class="id" title="tactic">generalize</span> (<span class="id" title="var">mf</span>:<span class="id" title="var">monotonic</span> <span class="id" title="var">f</span>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab152"></a><h3 class="section">Function for conditionnal choice defined as a morphism</h3>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fif</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : <span class="id" title="var">A</span> → <span class="id" title="var">A</span> → <span class="id" title="var">A</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">e1</span> <span class="id" title="keyword">else</span> <span class="id" title="var">e2</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">fif_mon2</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : <span class="id" title="var">monotonic2</span> (@<span class="id" title="var">fif</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Fif</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : <span class="id" title="var">A</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">A</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">A</span> := <span class="id" title="var">mon2</span> (@<span class="id" title="var">fif</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Fif_simpl</span> : <span class="id" title="keyword">∀</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">A</span>), <span class="id" title="var">Fif</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">fif</span> <span class="id" title="var">b</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Fif_continuous_right</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">e</span>:<span class="id" title="var">A</span>) : <span class="id" title="var">continuous</span> (<span class="id" title="var">Fif</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span>  <span class="id" title="var">Fif_continuous_left</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : <span class="id" title="var">continuous</span> (<span class="id" title="var">Fif</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">Fif_continuous_right</span> @<span class="id" title="var">Fif_continuous_left</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fif_continuous_left</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">A</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fif</span> <span class="id" title="var">b</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">Fif</span> <span class="id" title="var">b@f</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fif_continuous_left2</span> :<br/>
<span class="id" title="keyword">∀</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">o</span> : <span class="id" title="var">ord</span> <span class="id" title="var">A</span>) (<span class="id" title="var">c</span> : <span class="id" title="var">cpo</span> <span class="id" title="var">A</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">nat</span> -<span class="id" title="var">m</span>&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">g</span>:<span class="id" title="var">A</span>),<br/>
<span class="id" title="var">fif</span> <span class="id" title="var">b</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) <span class="id" title="var">g</span>  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">Fif</span> <span class="id" title="var">b</span> @ <span class="id" title="var">f</span>) <span class="id" title="var">g</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fif_continuous_right</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) <span class="id" title="var">e</span> (<span class="id" title="var">f</span>:<span class="id" title="var">nat</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">A</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fif</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>)  &asymp;  <span class="id" title="var">lub</span> (<span class="id" title="var">Fif</span> <span class="id" title="var">b</span> <span class="id" title="var">e@f</span>).<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> @<span class="id" title="var">fif_continuous_right</span> @<span class="id" title="var">fif_continuous_left</span> @<span class="id" title="var">fif_continuous_left2</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Fif_continuous2</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : <span class="id" title="var">continuous2</span> (<span class="id" title="var">Fif</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">b</span>).<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fif_continuous2</span> `{<span class="id" title="var">c</span>:<span class="id" title="var">cpo</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">f</span> <span class="id" title="var">g</span> : <span class="id" title="var">nat</span>-<span class="id" title="var">m</span>&gt; <span class="id" title="var">A</span>):<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">fif</span> <span class="id" title="var">b</span> (<span class="id" title="var">lub</span> <span class="id" title="var">f</span>) (<span class="id" title="var">lub</span> <span class="id" title="var">g</span>)  &asymp;  <span class="id" title="var">lub</span> ((<span class="id" title="var">Fif</span> <span class="id" title="var">b@2</span> <span class="id" title="var">f</span>) <span class="id" title="var">g</span>).<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : (@<span class="id" title="var">fif</span> <span class="id" title="var">A</span> <span class="id" title="var">b</span>) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Ole</span> &#8702; <span class="id" title="var">Ole</span> &#8702; <span class="id" title="var">Ole</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">fif_le_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
<span class="id" title="keyword">Add</span> <span class="id" title="var">Parametric</span> <span class="id" title="var">Morphism</span> `{<span class="id" title="var">o</span>:<span class="id" title="var">ord</span> <span class="id" title="var">A</span>} (<span class="id" title="var">b</span>:<span class="id" title="var">bool</span>) : (@<span class="id" title="var">fif</span> <span class="id" title="var">A</span> <span class="id" title="var">b</span>) <br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">signature</span> <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span> &#8702; <span class="id" title="var">Oeq</span><br/>
<span class="id" title="keyword">as</span> <span class="id" title="var">fif_eq_compat</span>.<br/>
<span class="id" title="keyword">Save</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>